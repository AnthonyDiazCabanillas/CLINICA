±
PD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\VariablesGlobales.cs
	namespace 	
Dat
 
. 
Oracle 
{ 
public 

static 
class 
VariablesGlobales )
{ 
public		 
static		 
string		 

CnnMedisyn		 '
=		( )
$str		* ,
;		, -
}

 
} Ûã
_D:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\MedisynAD\ReservasAD\AmReservaAD.cs
	namespace 	
Dat
 
. 
Oracle 
. 
	MedisynAD 
. 

ReservasAD )
{ 
public 

class 
AmReservaAD 
{ 
private 

AmReservaE 
LlenarEntidad (
(( )
IDataReader) 4
dr5 7
,7 8
int9 <
pOrden= C
=D E
$numF G
)G H
{ 	

AmReservaE 
oAmReservaE "
=# $
new% (

AmReservaE) 3
(3 4
)4 5
;5 6
switch 
( 
pOrden 
) 
{ 
case 
$num 
: 
{ 
oAmReservaE #
.# $
IdCorrelReserva$ 3
=4 5
(6 7
string7 =
)= >
dr> @
[@ A
$strA Q
]Q R
;R S
oAmReservaE #
.# $
FecIngresoReserva$ 5
=6 7
(8 9
DateTime9 A
)A B
drB D
[D E
$strE U
]U V
;V W
oAmReservaE #
.# $

FecReserva$ .
=/ 0
Convert1 8
.8 9

ToDateTime9 C
(C D
(D E
stringE K
)K L
drL N
[N O
$strO ^
]^ _
+` a
$strb e
+f g
(h i
stringi o
)o p
drp r
[r s
$str	s 
]
 ‚
)
‚ ƒ
;
ƒ „
oAmReservaE #
.# $

IdPaciente$ .
=/ 0
(1 2
int2 5
)5 6
dr6 8
[8 9
$str9 F
]F G
;G H
oAmReservaE #
.# $
IdPacienteReserva$ 5
=6 7
(8 9
int9 <
)< =
dr= ?
[? @
$str@ U
]U V
;V W
oAmReservaE #
.# $
CodEspecialidad$ 3
=4 5
(6 7
int7 :
): ;
dr; =
[= >
$str> P
]P Q
;Q R
oAmReservaE #
.# $
CodSucursal$ /
=0 1
(2 3
int3 6
)6 7
dr7 9
[9 :
$str: H
]H I
;I J
oAmReservaE #
.# $
Medico$ *
=+ ,
(- .
string. 4
)4 5
dr5 7
[7 8
$str8 @
]@ A
;A B
oAmReservaE   #
.  # $
EmailPaciente  $ 1
=  2 3
(  4 5
string  5 ;
)  ; <
dr  < >
[  > ?
$str  ? O
]  O P
;  P Q
break!! 
;!! 
}"" 
case$$ 
$num$$ 
:$$ 
{%% 
oAmReservaE&& #
.&&# $

BoxReserva&&$ .
=&&/ 0
dr&&1 3
[&&3 4
$str&&4 A
]&&A B
+&&C D
$str&&E G
;&&G H
oAmReservaE'' #
.''# $
	CodUnidad''$ -
=''. /
dr''0 2
[''2 3
$str''3 ?
]''? @
+''A B
$str''C E
;''E F
oAmReservaE(( #
.((# $

DescUnidad(($ .
=((/ 0
dr((1 3
[((3 4
$str((4 A
]((A B
+((C D
$str((E G
;((G H
break)) 
;)) 
}** 
case,, 
$num,, 
:,, 
{-- 
oAmReservaE.. #
...# $
CodProf..$ +
=.., -
dr... 0
[..0 1
$str..1 ;
]..; <
+..= >
$str..? A
;..A B
oAmReservaE// #
.//# $
IdAmbulatorio//$ 1
=//2 3
dr//4 6
[//6 7
$str//7 G
]//G H
+//I J
$str//K M
;//M N
oAmReservaE00 #
.00# $
IdCorrelReserva00$ 3
=004 5
dr006 8
[008 9
$str009 I
]00I J
+00K L
$str00M O
;00O P
oAmReservaE11 #
.11# $
CodEspecialidad11$ 3
=114 5
(116 7
int117 :
)11: ;
dr11; =
[11= >
$str11> P
]11P Q
;11Q R
oAmReservaE33 #
.33# $
RutPaciente33$ /
=330 1
(332 3
$str333 7
+338 9
(33: ;
dr33; =
[33= >
$str33> L
]33L M
+33N O
$str33P R
)33R S
)33S T
;33T U
oAmReservaE44 #
.44# $
RutPaciente44$ /
=440 1
oAmReservaE442 =
.44= >
RutPaciente44> I
.44I J
	Substring44J S
(44S T
oAmReservaE44T _
.44_ `
RutPaciente44` k
.44k l
Length44l r
-44s t
$num44u v
,44v w
$num44x y
)44y z
;44z {
oAmReservaE66 #
.66# $

FecReserva66$ .
=66/ 0
(661 2
DateTime662 :
)66: ;
dr66; =
[66= >
$str66> M
]66M N
;66N O
oAmReservaE77 #
.77# $
HoraReserva77$ /
=770 1
(772 3
DateTime773 ;
)77; <
dr77< >
[77> ?
$str77? M
]77M N
;77N O
oAmReservaE88 #
.88# $
CodSucursal88$ /
=880 1
(882 3
int883 6
)886 7
dr887 9
[889 :
$str88: H
]88H I
;88I J
oAmReservaE99 #
.99# $
DscSucursal99$ /
=990 1
(992 3
string993 9
)999 :
dr99: <
[99< =
$str99= K
]99K L
;99L M
break:: 
;:: 
};; 
}<< 
return>> 
oAmReservaE>> 
;>> 
}?? 	
publicAA 
ListAA 
<AA 

AmReservaEAA 
>AA &
ConsultarReservasPacientesAA  :
(AA: ;
refAA; >
intAA? B
CodReservaUltimoAAC S
)AAS T
{BB 	
IDataReaderCC 
drCC 
;CC 

AmReservaEDD 
objAmReservaEDD $
=DD% &
newDD' *

AmReservaEDD+ 5
(DD5 6
)DD6 7
;DD7 8
ListEE 
<EE 

AmReservaEEE 
>EE 
ListReservaEEE )
=EE* +
newEE, /
ListEE0 4
<EE4 5

AmReservaEEE5 ?
>EE? @
(EE@ A
)EEA B
;EEB C
stringFF 
	wSqlQueryFF 
=FF 
$strFF !
;FF! "
tryHH 
{II 
	wSqlQueryJJ 
=JJ 
$strJJ 
+JJ  
$strJJ! )
+JJ* +
$strJJ, @
+JJA B
$strJJC W
+JJX Y
$strJJZ m
+JJn o
$str	JJp ‚
+
JJƒ „
$str
JJ… –
+
JJ— ˜
$str
JJ™ ²
+
JJ³ ´
$str
JJµ É
+
JJÊ Ë
$str
JJÌ â
+
JJã ä
$str
JJå Ã
+
JJÄ Å
$str
JJÆ Ø
+
JJÙ Ú
$str
JJÛ ú
+
JJû ü
$str
JJı Ë
+
JJÌ Í
$str
JJÎ ˆ
+
JJ‰ Š
$str
JJ‹ ¦
+
JJ§ ¨
CodReservaUltimo
JJ© ¹
.
JJ¹ º
ToString
JJº Â
(
JJÂ Ã
)
JJÃ Ä
+
JJÅ Æ
$str
JJÇ ã
+
JJä å
$str
JJæ 
;
JJ ‚
usingLL 
(LL 
OracleConnectionLL '
cnnLL( +
=LL, -
newLL. 1
OracleConnectionLL2 B
(LLB C
VariablesGlobalesLLC T
.LLT U

CnnMedisynLLU _
)LL_ `
)LL` a
{MM 
usingNN 
(NN 
OracleCommandNN (
cmdNN) ,
=NN- .
newNN/ 2
OracleCommandNN3 @
(NN@ A
	wSqlQueryNNA J
,NNJ K
cnnNNL O
)NNO P
)NNP Q
{OO 
cmdPP 
.PP 
CommandTypePP '
=PP( )
CommandTypePP* 5
.PP5 6
TextPP6 :
;PP: ;
cnnQQ 
.QQ 
OpenQQ  
(QQ  !
)QQ! "
;QQ" #
drRR 
=RR 
cmdRR  
.RR  !
ExecuteReaderRR! .
(RR. /
)RR/ 0
;RR0 1
whileSS 
(SS 
drSS !
.SS! "
ReadSS" &
(SS& '
)SS' (
)SS( )
ListReservaETT (
.TT( )
AddTT) ,
(TT, -
LlenarEntidadTT- :
(TT: ;
drTT; =
)TT= >
)TT> ?
;TT? @
cmdUU 
.UU 
DisposeUU #
(UU# $
)UU$ %
;UU% &
cnnVV 
.VV 
DisposeVV #
(VV# $
)VV$ %
;VV% &
cnnWW 
.WW 
CloseWW !
(WW! "
)WW" #
;WW# $
}XX 
}YY 
}ZZ 
catch[[ 
([[ 
	Exception[[ 
ex[[ 
)[[  
{\\ 
throw]] 
new]] 
	Exception]] #
(]]# $
$str]]$ B
+]]C D
ex]]E G
.]]G H
Message]]H O
)]]O P
;]]P Q
}^^ 
return__ 
ListReservaE__ 
;__  
}`` 	
publicbb 
Listbb 
<bb 

AmReservaEbb 
>bb &
ConsultarReservaPacienteIdbb  :
(bb: ;
stringbb; A
CorrelReservabbB O
)bbO P
{cc 	
IDataReaderdd 
drdd 
;dd 

AmReservaEee 
objAmReservaEee $
=ee% &
newee' *

AmReservaEee+ 5
(ee5 6
)ee6 7
;ee7 8
Listff 
<ff 

AmReservaEff 
>ff 
ListReservaEff )
=ff* +
newff, /
Listff0 4
<ff4 5

AmReservaEff5 ?
>ff? @
(ff@ A
)ffA B
;ffB C
stringgg 
	wSqlQuerygg 
=gg 
$strgg !
;gg! "
tryii 
{jj 
	wSqlQuerykk 
=kk 
$strkk 
+kk  
$strkk! j
+kkk l
$str	kkm 
+
kk‚ ƒ
$str
kk„ ¸
+
kk¹ º
$str
kk» õ
+
kkö ÷
$str
kkø “
+
kk” •
CorrelReserva
kk– £
+
kk¤ ¥
$str
kk¦ ¨
;
kk¨ ©
usingmm 
(mm 
OracleConnectionmm '
cnnmm( +
=mm, -
newmm. 1
OracleConnectionmm2 B
(mmB C
VariablesGlobalesmmC T
.mmT U

CnnMedisynmmU _
)mm_ `
)mm` a
{nn 
usingoo 
(oo 
OracleCommandoo (
cmdoo) ,
=oo- .
newoo/ 2
OracleCommandoo3 @
(oo@ A
	wSqlQueryooA J
,ooJ K
cnnooL O
)ooO P
)ooP Q
{pp 
cmdqq 
.qq 
CommandTypeqq '
=qq( )
CommandTypeqq* 5
.qq5 6
Textqq6 :
;qq: ;
cnnrr 
.rr 
Openrr  
(rr  !
)rr! "
;rr" #
drss 
=ss 
cmdss  
.ss  !
ExecuteReaderss! .
(ss. /
)ss/ 0
;ss0 1
whilett 
(tt 
drtt !
.tt! "
Readtt" &
(tt& '
)tt' (
)tt( )
ListReservaEuu (
.uu( )
Adduu) ,
(uu, -
LlenarEntidaduu- :
(uu: ;
druu; =
,uu= >
$numuu? @
)uu@ A
)uuA B
;uuB C
cmdvv 
.vv 
Disposevv #
(vv# $
)vv$ %
;vv% &
cnnww 
.ww 
Disposeww #
(ww# $
)ww$ %
;ww% &
cnnxx 
.xx 
Closexx !
(xx! "
)xx" #
;xx# $
}yy 
}zz 
}{{ 
catch|| 
(|| 
	Exception|| 
ex|| 
)||  
{}} 
throw~~ 
new~~ 
	Exception~~ #
(~~# $
$str~~$ B
+~~C D
ex~~E G
.~~G H
Message~~H O
)~~O P
;~~P Q
} 
return
€€ 
ListReservaE
€€ 
;
€€  
}
 	
public
„„ 

AmReservaE
„„  
ObtenerInfoReserva
„„ ,
(
„„, -

AmReservaE
„„- 7
pObjAmReserva
„„8 E
)
„„E F
{
…… 	
IDataReader
†† 
dr
†† 
;
†† 

AmReservaE
‡‡ 
objGenEnvioMailE
‡‡ '
=
‡‡( )
new
‡‡* -

AmReservaE
‡‡. 8
(
‡‡8 9
)
‡‡9 :
;
‡‡: ;
string
ˆˆ 
	wSqlQuery
ˆˆ 
=
ˆˆ 
$str
ˆˆ !
;
ˆˆ! "
try
ŠŠ 
{
‹‹ 
	wSqlQuery
ŒŒ 
=
ŒŒ 
$str
ŒŒ %
+
ŒŒ& '
$str
ŒŒ( ~
+ŒŒ €
$strŒŒ Î
+ŒŒÏ Ğ
$strŒŒÑ å
+ŒŒæ ç
$strŒŒè «
+ŒŒ¬ ­
$strŒŒ® ı
+ŒŒş ÿ
$strŒŒ€ œ
+ŒŒ 
pObjAmReservaŒŒŸ ¬
.ŒŒ¬ ­
IdCorrelReservaŒŒ­ ¼
+ŒŒ½ ¾
$strŒŒ¿ Â
;ŒŒÂ Ã
using
 
(
 
OracleConnection
 '
cnn
( +
=
, -
new
. 1
OracleConnection
2 B
(
B C
VariablesGlobales
C T
.
T U

CnnMedisyn
U _
)
_ `
)
` a
{
 
using
 
(
 
OracleCommand
 (
cmd
) ,
=
- .
new
/ 2
OracleCommand
3 @
(
@ A
	wSqlQuery
A J
,
J K
cnn
L O
)
O P
)
P Q
{
‘‘ 
cmd
’’ 
.
’’ 
CommandType
’’ '
=
’’( )
CommandType
’’* 5
.
’’5 6
Text
’’6 :
;
’’: ;
cnn
““ 
.
““ 
Open
““  
(
““  !
)
““! "
;
““" #
dr
”” 
=
”” 
cmd
””  
.
””  !
ExecuteReader
””! .
(
””. /
)
””/ 0
;
””0 1
while
•• 
(
•• 
dr
•• !
.
••! "
Read
••" &
(
••& '
)
••' (
)
••( )
objGenEnvioMailE
–– ,
=
––- .
LlenarEntidad
––/ <
(
––< =
dr
––= ?
,
––? @
pObjAmReserva
––A N
.
––N O
ORDEN
––O T
)
––T U
;
––U V
dr
—— 
.
—— 
Dispose
—— "
(
——" #
)
——# $
;
——$ %
dr
˜˜ 
.
˜˜ 
Close
˜˜  
(
˜˜  !
)
˜˜! "
;
˜˜" #
cmd
™™ 
.
™™ 
Dispose
™™ #
(
™™# $
)
™™$ %
;
™™% &
cnn
šš 
.
šš 
Dispose
šš #
(
šš# $
)
šš$ %
;
šš% &
cnn
›› 
.
›› 
Close
›› !
(
››! "
)
››" #
;
››# $
}
œœ 
}
 
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   
throw
¡¡ 
new
¡¡ 
	Exception
¡¡ #
(
¡¡# $
$str
¡¡$ R
+
¡¡S T
ex
¡¡U W
.
¡¡W X
Message
¡¡X _
)
¡¡_ `
;
¡¡` a
}
¢¢ 
return
¤¤ 
objGenEnvioMailE
¤¤ #
;
¤¤# $
}
¥¥ 	
public
¬¬ 
bool
¬¬ ,
VerificarCitaPacienteMedicoDia
¬¬ 2
(
¬¬2 3

AmReservaE
¬¬3 =
pObjAmReserva
¬¬> K
)
¬¬K L
{
­­ 	
bool
®® 
result
®® 
=
®® 
false
®® 
;
®®  
try
°° 
{
±± 
using
²² 
(
²² 
OracleConnection
²² '
cnn
²²( +
=
²², -
new
²². 1
OracleConnection
²²2 B
(
²²B C
VariablesGlobales
²²C T
.
²²T U

CnnMedisyn
²²U _
)
²²_ `
)
²²` a
{
³³ 
using
´´ 
(
´´ 
OracleCommand
´´ (
cmd
´´) ,
=
´´- .
new
´´/ 2
OracleCommand
´´3 @
(
´´@ A
$str
´´A v
,
´´v w
cnn
´´x {
)
´´{ |
)
´´| }
{
µµ 
cnn
¶¶ 
.
¶¶ 
Open
¶¶  
(
¶¶  !
)
¶¶! "
;
¶¶" #
cmd
·· 
.
·· 
CommandType
·· '
=
··( )
CommandType
··* 5
.
··5 6
StoredProcedure
··6 E
;
··E F
cmd
¹¹ 
.
¹¹ 

Parameters
¹¹ &
.
¹¹& '
Add
¹¹' *
(
¹¹* +
$str
¹¹+ ?
,
¹¹? @
OracleDbType
¹¹A M
.
¹¹M N
Int64
¹¹N S
)
¹¹S T
.
¹¹T U
Value
¹¹U Z
=
¹¹[ \
pObjAmReserva
¹¹] j
.
¹¹j k
IdAmbulatorio
¹¹k x
;
¹¹x y
cmd
ºº 
.
ºº 

Parameters
ºº &
.
ºº& '
Add
ºº' *
(
ºº* +
$str
ºº+ >
,
ºº> ?
OracleDbType
ºº@ L
.
ººL M
	NVarchar2
ººM V
)
ººV W
.
ººW X
Value
ººX ]
=
ºº^ _
pObjAmReserva
ºº` m
.
ººm n
FecReserva_String
ººn 
;ºº €
cmd
»» 
.
»» 

Parameters
»» &
.
»»& '
Add
»»' *
(
»»* +
$str
»»+ ?
,
»»? @
OracleDbType
»»A M
.
»»M N
Int64
»»N S
)
»»S T
.
»»T U
Value
»»U Z
=
»»[ \
pObjAmReserva
»»] j
.
»»j k
CorrelHorario
»»k x
;
»»x y
cmd
¼¼ 
.
¼¼ 

Parameters
¼¼ &
.
¼¼& '
Add
¼¼' *
(
¼¼* +
$str
¼¼+ ;
,
¼¼; <
OracleDbType
¼¼= I
.
¼¼I J
	RefCursor
¼¼J S
,
¼¼S T 
ParameterDirection
¼¼U g
.
¼¼g h
Output
¼¼h n
)
¼¼n o
;
¼¼o p
IDataReader
½½ #
dr
½½$ &
=
½½' (
cmd
½½) ,
.
½½, -
ExecuteReader
½½- :
(
½½: ;
)
½½; <
;
½½< =
while
¿¿ 
(
¿¿ 
dr
¿¿ !
.
¿¿! "
Read
¿¿" &
(
¿¿& '
)
¿¿' (
)
¿¿( )
result
ÀÀ "
=
ÀÀ# $
true
ÀÀ% )
;
ÀÀ) *
dr
ÂÂ 
.
ÂÂ 
Dispose
ÂÂ "
(
ÂÂ" #
)
ÂÂ# $
;
ÂÂ$ %
dr
ÃÃ 
.
ÃÃ 
Close
ÃÃ  
(
ÃÃ  !
)
ÃÃ! "
;
ÃÃ" #
cmd
ÄÄ 
.
ÄÄ 
Dispose
ÄÄ #
(
ÄÄ# $
)
ÄÄ$ %
;
ÄÄ% &
}
ÅÅ 
cnn
ÇÇ 
.
ÇÇ 
Dispose
ÇÇ 
(
ÇÇ  
)
ÇÇ  !
;
ÇÇ! "
cnn
ÈÈ 
.
ÈÈ 
Close
ÈÈ 
(
ÈÈ 
)
ÈÈ 
;
ÈÈ  
}
ÉÉ 
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÌÌ 
throw
ÍÍ 
new
ÍÍ 
	Exception
ÍÍ #
(
ÍÍ# $
$str
ÍÍ$ ^
+
ÍÍ_ `
ex
ÍÍa c
.
ÍÍc d
Message
ÍÍd k
)
ÍÍk l
;
ÍÍl m
}
ÎÎ 
return
ĞĞ 
result
ĞĞ 
;
ĞĞ 
}
ÑÑ 	
public
×× 
List
×× 
<
×× 
AgendaDatos
×× 
>
××  $
ObtieneAgendaXApellido
××! 7
(
××7 8
int
××8 ;
Cod_Empresa
××< G
,
××G H
int
××I L
Cod_Sucursal
××M Y
,
××Y Z
string
××[ a
ApelPat_prof
××b n
)
××n o
{
ØØ 	
var
ÙÙ 
oList
ÙÙ 
=
ÙÙ 
new
ÙÙ 
List
ÙÙ  
<
ÙÙ  !
AgendaDatos
ÙÙ! ,
>
ÙÙ, -
(
ÙÙ- .
)
ÙÙ. /
;
ÙÙ/ 0
try
ÛÛ 
{
ÜÜ 
using
İİ 
(
İİ 
OracleConnection
İİ '
cnn
İİ( +
=
İİ, -
new
İİ. 1
OracleConnection
İİ2 B
(
İİB C
VariablesGlobales
İİC T
.
İİT U

CnnMedisyn
İİU _
)
İİ_ `
)
İİ` a
{
ŞŞ 
using
ßß 
(
ßß 
OracleCommand
ßß (
cmd
ßß) ,
=
ßß- .
new
ßß/ 2
OracleCommand
ßß3 @
(
ßß@ A
$str
ßßA d
,
ßßd e
cnn
ßßf i
)
ßßi j
)
ßßj k
{
àà 
cnn
áá 
.
áá 
Open
áá  
(
áá  !
)
áá! "
;
áá" #
cmd
ââ 
.
ââ 
CommandType
ââ '
=
ââ( )
CommandType
ââ* 5
.
ââ5 6
StoredProcedure
ââ6 E
;
ââE F
cmd
ää 
.
ää 

Parameters
ää &
.
ää& '
Add
ää' *
(
ää* +
$str
ää+ ;
,
ää; <
OracleDbType
ää= I
.
ääI J
Int64
ääJ O
)
ääO P
.
ääP Q
Value
ääQ V
=
ääW X
Cod_Empresa
ääY d
;
ääd e
cmd
åå 
.
åå 

Parameters
åå &
.
åå& '
Add
åå' *
(
åå* +
$str
åå+ <
,
åå< =
OracleDbType
åå> J
.
ååJ K
Int64
ååK P
)
ååP Q
.
ååQ R
Value
ååR W
=
ååX Y
Cod_Sucursal
ååZ f
;
ååf g
cmd
ææ 
.
ææ 

Parameters
ææ &
.
ææ& '
Add
ææ' *
(
ææ* +
$str
ææ+ ;
,
ææ; <
OracleDbType
ææ= I
.
ææI J
	NVarchar2
ææJ S
)
ææS T
.
ææT U
Value
ææU Z
=
ææ[ \
ApelPat_prof
ææ] i
;
ææi j
cmd
çç 
.
çç 

Parameters
çç &
.
çç& '
Add
çç' *
(
çç* +
$str
çç+ 4
,
çç4 5
OracleDbType
çç6 B
.
ççB C
	RefCursor
ççC L
,
ççL M 
ParameterDirection
ççN `
.
çç` a
Output
çça g
)
ççg h
;
ççh i
IDataReader
éé #
dr
éé$ &
=
éé' (
cmd
éé) ,
.
éé, -
ExecuteReader
éé- :
(
éé: ;
)
éé; <
;
éé< =
var
êê 
obj
êê 
=
êê  !
new
êê" %
AgendaDatos
êê& 1
(
êê1 2
)
êê2 3
;
êê3 4
while
ëë 
(
ëë 
dr
ëë !
.
ëë! "
Read
ëë" &
(
ëë& '
)
ëë' (
)
ëë( )
{
ìì 
obj
íí 
=
íí  !
new
íí" %
AgendaDatos
íí& 1
(
íí1 2
)
íí2 3
;
íí3 4
obj
îî 
.
îî  
cOD_SUCURSAL
îî  ,
=
îî- .
(
îî/ 0
byte
îî0 4
)
îî4 5
dr
îî5 7
[
îî7 8
$str
îî8 F
]
îîF G
;
îîG H
obj
ïï 
.
ïï  
sUCURSAL
ïï  (
=
ïï) *
(
ïï+ ,
string
ïï, 2
)
ïï2 3
dr
ïï3 5
[
ïï5 6
$str
ïï6 @
]
ïï@ A
;
ïïA B
obj
ğğ 
.
ğğ  
cOD_PROF
ğğ  (
=
ğğ) *
(
ğğ+ ,
ushort
ğğ, 2
)
ğğ2 3
dr
ğğ3 5
[
ğğ5 6
$str
ğğ6 @
]
ğğ@ A
;
ğğA B
obj
ññ 
.
ññ  
rUT_PROF
ññ  (
=
ññ) *
(
ññ+ ,
uint
ññ, 0
)
ññ0 1
dr
ññ1 3
[
ññ3 4
$str
ññ4 >
]
ññ> ?
;
ññ? @
obj
òò 
.
òò  
aPEPAT_PROF
òò  +
=
òò, -
(
òò. /
string
òò/ 5
)
òò5 6
dr
òò6 8
[
òò8 9
$str
òò9 F
]
òòF G
;
òòG H
obj
óó 
.
óó  
aPEMAT_PROF
óó  +
=
óó, -
(
óó. /
string
óó/ 5
)
óó5 6
dr
óó6 8
[
óó8 9
$str
óó9 F
]
óóF G
;
óóG H
obj
ôô 
.
ôô  
nOMBRE1_PROF
ôô  ,
=
ôô- .
(
ôô/ 0
string
ôô0 6
)
ôô6 7
dr
ôô7 9
[
ôô9 :
$str
ôô: H
]
ôôH I
;
ôôI J
obj
õõ 
.
õõ  
cOD_ESPECIALIDAD
õõ  0
=
õõ1 2
(
õõ3 4
byte
õõ4 8
)
õõ8 9
dr
õõ9 ;
[
õõ; <
$str
õõ< N
]
õõN O
;
õõO P
obj
öö 
.
öö  
	dESC_ITEM
öö  )
=
öö* +
(
öö, -
string
öö- 3
)
öö3 4
dr
öö4 6
[
öö6 7
$str
öö7 B
]
ööB C
;
ööC D
obj
÷÷ 
.
÷÷  

cORRAGENDA
÷÷  *
=
÷÷+ ,
(
÷÷- .
ushort
÷÷. 4
)
÷÷4 5
dr
÷÷5 7
[
÷÷7 8
$str
÷÷8 D
]
÷÷D E
;
÷÷E F
obj
øø 
.
øø  "
fECHAINICPROX_AGENDA
øø  4
=
øø5 6
(
øø7 8
string
øø8 >
)
øø> ?
dr
øø? A
[
øøA B
$str
øøB X
]
øøX Y
;
øøY Z
obj
ùù 
.
ùù  
fECHA_SISTEMA
ùù  -
=
ùù. /
(
ùù0 1
string
ùù1 7
)
ùù7 8
dr
ùù8 :
[
ùù: ;
$str
ùù; J
]
ùùJ K
;
ùùK L
obj
úú 
.
úú  

cOD_UNIDAD
úú  *
=
úú+ ,
(
úú- .
byte
úú. 2
)
úú2 3
dr
úú3 5
[
úú5 6
$str
úú6 B
]
úúB C
;
úúC D
obj
ûû 
.
ûû  
dESC_UNIDAD
ûû  +
=
ûû, -
(
ûû. /
string
ûû/ 5
)
ûû5 6
dr
ûû6 8
[
ûû8 9
$str
ûû9 F
]
ûûF G
;
ûûG H
obj
üü 
.
üü  
hMUL
üü  $
=
üü% &
(
üü' (
byte
üü( ,
)
üü, -
dr
üü- /
[
üü/ 0
$str
üü0 6
]
üü6 7
;
üü7 8
obj
ıı 
.
ıı  
vERSTAFF
ıı  (
=
ıı) *
(
ıı+ ,
string
ıı, 2
)
ıı2 3
dr
ıı3 5
[
ıı5 6
$str
ıı6 @
]
ıı@ A
;
ııA B
obj
şş 
.
şş  %
pROXIMA_HORA_DISPONIBLE
şş  7
=
şş8 9
(
şş: ;
DateTime
şş; C
)
şşC D
dr
şşD F
[
şşF G
$str
şşG `
]
şş` a
;
şşa b
obj
ÿÿ 
.
ÿÿ  *
pROXIMA_HORA_DISPONIBLE_CHAR
ÿÿ  <
=
ÿÿ= >
(
ÿÿ? @
string
ÿÿ@ F
)
ÿÿF G
dr
ÿÿG I
[
ÿÿI J
$str
ÿÿJ h
]
ÿÿh i
;
ÿÿi j
oList
›› !
.
››! "
Add
››" %
(
››% &
obj
››& )
)
››) *
;
››* +
}
œœ 
dr
 
.
 
Dispose
 "
(
" #
)
# $
;
$ %
dr
ŸŸ 
.
ŸŸ 
Close
ŸŸ  
(
ŸŸ  !
)
ŸŸ! "
;
ŸŸ" #
cmd
   
.
   
Dispose
   #
(
  # $
)
  $ %
;
  % &
}
¡¡ 
cnn
££ 
.
££ 
Dispose
££ 
(
££  
)
££  !
;
££! "
cnn
¤¤ 
.
¤¤ 
Close
¤¤ 
(
¤¤ 
)
¤¤ 
;
¤¤  
}
¥¥ 
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§ 
ex
§§ 
)
§§  
{
¨¨ 
throw
©© 
new
©© 
	Exception
©© #
(
©©# $
$str
©©$ V
+
©©W X
ex
©©Y [
.
©©[ \
Message
©©\ c
)
©©c d
;
©©d e
}
ªª 
return
¬¬ 
oList
¬¬ 
;
¬¬ 
}
­­ 	
}
®® 
}¯¯ ù‚
cD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\MedisynAD\PacientesAD\TabPacientesAD.cs
	namespace 	
Dat
 
. 
Oracle 
. 
	MedisynAD 
. 
PacientesAD *
{ 
public 

class 
TabPacientesAD 
{ 
private 
TabPacienteE 
LlenarEntidad *
(* +
IDataReader+ 6
dr7 9
,9 :
int; >
pOrden? E
=F G
$numH I
)I J
{ 	
TabPacienteE 
oTabPacienteE &
=' (
new) ,
TabPacienteE- 9
(9 :
): ;
;; <
oTabPacienteE 
. 
IdAmbulatorio '
=( )
(* +
string+ 1
)1 2
dr2 4
[4 5
$str5 E
]E F
;F G
oTabPacienteE 
. !
UserW_IdGrupoFamiliar /
=0 1
(2 3
string3 9
)9 :
dr: <
[< =
$str= P
]P Q
;Q R
oTabPacienteE 
. 
UserW_CodParentesco -
=. /
dr0 2
[2 3
$str3 ?
]? @
+A B
$strC E
;E F
oTabPacienteE 
. 
UserW_CodParentesco -
=. /
(0 1
oTabPacienteE1 >
.> ?
UserW_CodParentesco? R
==S U
$strV X
?Y Z
$str[ ^
:_ `
oTabPacienteEa n
.n o 
UserW_CodParentesco	o ‚
)
‚ ƒ
;
ƒ „
switch 
( 
oTabPacienteE !
.! "
UserW_CodParentesco" 5
)5 6
{ 
case 
$str 
: 
{ 
oTabPacienteE %
.% &
UserW_DscParentesco& 9
=: ;
$str< E
;E F
break 
; 
} 
case   
$str   
:   
{!! 
oTabPacienteE"" %
.""% &
UserW_DscParentesco""& 9
="": ;
$str""< E
;""E F
break## 
;## 
}$$ 
case&& 
$str&& 
:&& 
{'' 
oTabPacienteE(( %
.((% &
UserW_DscParentesco((& 9
=((: ;
$str((< B
;((B C
break)) 
;)) 
}** 
default,, 
:,, 
{-- 
oTabPacienteE.. %
...% &
UserW_DscParentesco..& 9
=..: ;
$str..< E
;..E F
break// 
;// 
}00 
}11 
return33 
oTabPacienteE33  
;33  !
}44 	
public66 
List66 
<66 
TabPacienteE66  
>66  !'
ObtenerGrupoFamiliarPackAge66" =
(66= >
string66> D

IdPaciente66E O
)66O P
{77 	
TabPacienteE88 
objAmReservaE88 &
=88' (
new88) ,
TabPacienteE88- 9
(889 :
)88: ;
;88; <
List99 
<99 
TabPacienteE99 
>99 
ListReservaE99 +
=99, -
new99. 1
List992 6
<996 7
TabPacienteE997 C
>99C D
(99D E
)99E F
;99F G
try;; 
{<< 
string== 
	wSqlQuery==  
===! "
$str==# N
;==N O
using?? 
(?? 
OracleConnection?? '
cnn??( +
=??, -
new??. 1
OracleConnection??2 B
(??B C
VariablesGlobales??C T
.??T U

CnnMedisyn??U _
)??_ `
)??` a
{@@ 
usingAA 
(AA 
OracleCommandAA (
cmdAA) ,
=AA- .
newAA/ 2
OracleCommandAA3 @
(AA@ A
	wSqlQueryAAA J
,AAJ K
cnnAAL O
)AAO P
)AAP Q
{BB 
cnnCC 
.CC 
OpenCC  
(CC  !
)CC! "
;CC" #
cmdDD 
.DD 
CommandTypeDD '
=DD( )
CommandTypeDD* 5
.DD5 6
StoredProcedureDD6 E
;DDE F
cmdEE 
.EE 

ParametersEE &
.EE& '
AddEE' *
(EE* +
$strEE+ ?
,EE? @
OracleDbTypeEEA M
.EEM N
Int64EEN S
)EES T
.EET U
ValueEEU Z
=EE[ \

IdPacienteEE] g
;EEg h
cmdFF 
.FF 

ParametersFF &
.FF& '
AddFF' *
(FF* +
$strFF+ ;
,FF; <
OracleDbTypeFF= I
.FFI J
	RefCursorFFJ S
,FFS T
ParameterDirectionFFU g
.FFg h
OutputFFh n
)FFn o
;FFo p
OracleDataReaderGG (
drGG) +
=GG, -
cmdGG. 1
.GG1 2
ExecuteReaderGG2 ?
(GG? @
)GG@ A
;GGA B
TabPacienteEII $
objPacienteII% 0
=II1 2
newII3 6
TabPacienteEII7 C
(IIC D
)IID E
;IIE F
whileJJ 
(JJ 
drJJ !
.JJ! "
ReadJJ" &
(JJ& '
)JJ' (
)JJ( )
ListReservaEKK (
.KK( )
AddKK) ,
(KK, -
LlenarEntidadKK- :
(KK: ;
drKK; =
,KK= >
$numKK? @
)KK@ A
)KKA B
;KKB C
cmdMM 
.MM 
DisposeMM #
(MM# $
)MM$ %
;MM% &
}NN 
cnnPP 
.PP 
DisposePP 
(PP  
)PP  !
;PP! "
cnnQQ 
.QQ 
CloseQQ 
(QQ 
)QQ 
;QQ  
}RR 
}SS 
catchTT 
(TT 
	ExceptionTT 
exTT 
)TT  
{UU 
throwVV 
newVV 
	ExceptionVV #
(VV# $
$strVV$ B
+VVC D
exVVE G
.VVG H
MessageVVH O
)VVO P
;VVP Q
}WW 
returnYY 
ListReservaEYY 
;YY  
}ZZ 	
public\\ 
DataSet\\ 
ObtenerDepatamentos\\ *
(\\* +
string\\+ 1

CodEmpresa\\2 <
)\\< =
{]] 	
TabPacienteE^^ 
objAmReservaE^^ &
=^^' (
new^^) ,
TabPacienteE^^- 9
(^^9 :
)^^: ;
;^^; <
List__ 
<__ 
TabPacienteE__ 
>__ 
ListReservaE__ +
=__, -
new__. 1
List__2 6
<__6 7
TabPacienteE__7 C
>__C D
(__D E
)__E F
;__F G
string`` 
	wSqlQuery`` 
=`` 
$str`` !
;``! "
DataSetaa 
dsaa 
=aa 
newaa 
DataSetaa $
(aa$ %
)aa% &
;aa& '
trycc 
{dd 
	wSqlQueryee 
=ee 
$stree 5
;ee5 6
OracleConnectiongg  
cnngg! $
=gg% &
newgg' *
OracleConnectiongg+ ;
(gg; <
VariablesGlobalesgg< M
.ggM N

CnnMedisynggN X
)ggX Y
;ggY Z
cnnhh 
.hh 
Openhh 
(hh 
)hh 
;hh 
OracleCommandii 
cmdii !
=ii" #
newii$ '
OracleCommandii( 5
(ii5 6
)ii6 7
;ii7 8
cmdll 
.ll 
CommandTextll 
=ll  !
	wSqlQueryll" +
;ll+ ,
cmdmm 
.mm 
CommandTypemm 
=mm  !
CommandTypemm" -
.mm- .
StoredProceduremm. =
;mm= >
cmdnn 
.nn 

Parametersnn 
.nn 
Addnn "
(nn" #
$strnn# 4
,nn4 5
OracleDbTypenn6 B
.nnB C
LongnnC G
,nnG H
$numnnI J
,nnJ K

CodEmpresannL V
,nnV W
ParameterDirectionnnX j
.nnj k
Inputnnk p
)nnp q
;nnq r
cmdoo 
.oo 

Parametersoo 
.oo 
Addoo "
(oo" #
$stroo# 3
,oo3 4
OracleDbTypeoo5 A
.ooA B
	RefCursorooB K
,ooK L
ParameterDirectionooM _
.oo_ `
Outputoo` f
)oof g
;oog h
cmdpp 
.pp 

Connectionpp 
=pp  
cnnpp! $
;pp$ %
OracleDataAdapterqq !
daqq" $
=qq% &
newqq' *
OracleDataAdapterqq+ <
(qq< =
cmdqq= @
)qq@ A
;qqA B
dass 
.ss 
Fillss 
(ss 
dsss 
)ss 
;ss 
cmduu 
.uu 
Disposeuu 
(uu 
)uu 
;uu 
cnnvv 
.vv 
Disposevv 
(vv 
)vv 
;vv 
cnnww 
.ww 
Closeww 
(ww 
)ww 
;ww 
}xx 
catchyy 
(yy 
	Exceptionyy 
exyy 
)yy  
{zz 
throw{{ 
new{{ 
	Exception{{ #
({{# $
$str{{$ B
+{{C D
ex{{E G
.{{G H
Message{{H O
){{O P
;{{P Q
}|| 
return}} 
ds}} 
;}} 
}~~ 	
public
 
List
 
<
 
TabPacienteE
  
>
  !#
ObtenerGrupoFamiliar2
" 7
(
7 8
string
8 >
IdAmbulatoria
? L
)
L M
{
‚‚ 	
IDataReader
ƒƒ 
dr
ƒƒ 
;
ƒƒ 
TabPacienteE
„„ 
objAmReservaE
„„ &
=
„„' (
new
„„) ,
TabPacienteE
„„- 9
(
„„9 :
)
„„: ;
;
„„; <
List
…… 
<
…… 
TabPacienteE
…… 
>
…… 
ListReservaE
…… +
=
……, -
new
……. 1
List
……2 6
<
……6 7
TabPacienteE
……7 C
>
……C D
(
……D E
)
……E F
;
……F G
string
†† 
	wSqlQuery
†† 
=
†† 
$str
†† !
;
††! "
try
‰‰ 
{
ŠŠ 
	wSqlQuery
‹‹ 
=
‹‹ 
$str
‹‹ 
+
‹‹  
$str
‹‹! *
+
‹‹+ ,
$str
‹‹- c
+
‹‹d e
$str‹‹f ‰
+‹‹Š ‹
$str‹‹Œ Ì
+‹‹Í Î
$str‹‹Ï ê
+‹‹ë ì
IdAmbulatoria‹‹í ú
.‹‹ú û
Trim‹‹û ÿ
(‹‹ÿ €
)‹‹€ 
+‹‹‚ ƒ
$str‹‹„ ±
;‹‹± ²
using
 
(
 
OracleConnection
 '
cnn
( +
=
, -
new
. 1
OracleConnection
2 B
(
B C
VariablesGlobales
C T
.
T U

CnnMedisyn
U _
)
_ `
)
` a
{
 
using
 
(
 
OracleCommand
 (
cmd
) ,
=
- .
new
/ 2
OracleCommand
3 @
(
@ A
	wSqlQuery
A J
,
J K
cnn
L O
)
O P
)
P Q
{
 
cmd
‘‘ 
.
‘‘ 
CommandType
‘‘ '
=
‘‘( )
CommandType
‘‘* 5
.
‘‘5 6
Text
‘‘6 :
;
‘‘: ;
cnn
’’ 
.
’’ 
Open
’’  
(
’’  !
)
’’! "
;
’’" #
dr
““ 
=
““ 
cmd
““  
.
““  !
ExecuteReader
““! .
(
““. /
)
““/ 0
;
““0 1
while
”” 
(
”” 
dr
”” !
.
””! "
Read
””" &
(
””& '
)
””' (
)
””( )
ListReservaE
•• (
.
••( )
Add
••) ,
(
••, -
LlenarEntidad
••- :
(
••: ;
dr
••; =
)
••= >
)
••> ?
;
••? @
cmd
–– 
.
–– 
Dispose
–– #
(
––# $
)
––$ %
;
––% &
cnn
—— 
.
—— 
Dispose
—— #
(
——# $
)
——$ %
;
——% &
cnn
˜˜ 
.
˜˜ 
Close
˜˜ !
(
˜˜! "
)
˜˜" #
;
˜˜# $
}
™™ 
}
šš 
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
throw
 
new
 
	Exception
 #
(
# $
$str
$ =
+
> ?
ex
@ B
.
B C
Message
C J
)
J K
;
K L
}
ŸŸ 
return
   
ListReservaE
   
;
    
}
¡¡ 	
public
¨¨ 
List
¨¨ 
<
¨¨ 
TabPacienteE
¨¨  
>
¨¨  !0
"ObtenerGrupoFamiliarxIdAmbulatorio
¨¨" D
(
¨¨D E
string
¨¨E K
IdAmbulatoria
¨¨L Y
)
¨¨Y Z
{
©© 	
IDataReader
ªª 
dr
ªª 
;
ªª 
TabPacienteE
«« 
objAmReservaE
«« &
=
««' (
new
««) ,
TabPacienteE
««- 9
(
««9 :
)
««: ;
;
««; <
List
¬¬ 
<
¬¬ 
TabPacienteE
¬¬ 
>
¬¬ 
ListReservaE
¬¬ +
=
¬¬, -
new
¬¬. 1
List
¬¬2 6
<
¬¬6 7
TabPacienteE
¬¬7 C
>
¬¬C D
(
¬¬D E
)
¬¬E F
;
¬¬F G
string
­­ 
	wSqlQuery
­­ 
=
­­ 
$str
­­ !
;
­­! "
try
°° 
{
±± 
	wSqlQuery
²² 
=
²² 
$str
²² 
+
²²  
$str
²²! ~
+²² €
$str
³³! D
+
³³E F
$str´´! ¨
+´´© ª
IdAmbulatoria´´« ¸
.´´¸ ¹
Trim´´¹ ½
(´´½ ¾
)´´¾ ¿
+´´À Á
$str´´Â Ú
;´´Ú Û
using
¶¶ 
(
¶¶ 
OracleConnection
¶¶ '
cnn
¶¶( +
=
¶¶, -
new
¶¶. 1
OracleConnection
¶¶2 B
(
¶¶B C
VariablesGlobales
¶¶C T
.
¶¶T U

CnnMedisyn
¶¶U _
)
¶¶_ `
)
¶¶` a
{
·· 
using
¸¸ 
(
¸¸ 
OracleCommand
¸¸ (
cmd
¸¸) ,
=
¸¸- .
new
¸¸/ 2
OracleCommand
¸¸3 @
(
¸¸@ A
	wSqlQuery
¸¸A J
,
¸¸J K
cnn
¸¸L O
)
¸¸O P
)
¸¸P Q
{
¹¹ 
cmd
ºº 
.
ºº 
CommandType
ºº '
=
ºº( )
CommandType
ºº* 5
.
ºº5 6
Text
ºº6 :
;
ºº: ;
cnn
»» 
.
»» 
Open
»»  
(
»»  !
)
»»! "
;
»»" #
dr
¼¼ 
=
¼¼ 
cmd
¼¼  
.
¼¼  !
ExecuteReader
¼¼! .
(
¼¼. /
)
¼¼/ 0
;
¼¼0 1
while
½½ 
(
½½ 
dr
½½ !
.
½½! "
Read
½½" &
(
½½& '
)
½½' (
)
½½( )
ListReservaE
¾¾ (
.
¾¾( )
Add
¾¾) ,
(
¾¾, -
LlenarEntidad
¾¾- :
(
¾¾: ;
dr
¾¾; =
)
¾¾= >
)
¾¾> ?
;
¾¾? @
cmd
¿¿ 
.
¿¿ 
Dispose
¿¿ #
(
¿¿# $
)
¿¿$ %
;
¿¿% &
cnn
ÀÀ 
.
ÀÀ 
Dispose
ÀÀ #
(
ÀÀ# $
)
ÀÀ$ %
;
ÀÀ% &
cnn
ÁÁ 
.
ÁÁ 
Close
ÁÁ !
(
ÁÁ! "
)
ÁÁ" #
;
ÁÁ# $
}
ÂÂ 
}
ÃÃ 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÆÆ 
throw
ÇÇ 
new
ÇÇ 
	Exception
ÇÇ #
(
ÇÇ# $
$str
ÇÇ$ =
+
ÇÇ> ?
ex
ÇÇ@ B
.
ÇÇB C
Message
ÇÇC J
)
ÇÇJ K
;
ÇÇK L
}
ÈÈ 
return
ÉÉ 
ListReservaE
ÉÉ 
;
ÉÉ  
}
ÊÊ 	
}
ËË 
}ÌÌ ©_
ZD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\MedisynAD\HisADTAD\HisADTAD.cs
	namespace

 	
Dat


 
.

 
Oracle

 
.

 
	MedisynAD

 
.

 
HisADTAD

 '
{ 
public 

class 
HisADTAD 
{ 
public 
string 
Insert_HIS_ADT $
($ %
int% (
COD_EMPRESA) 4
,4 5
string6 <
COD_SUCURSAL= I
,I J
stringK Q
EVENT_IDR Z
,Z [
string\ b
EVENT_DATETIMEc q
,q r
strings y
EVENT_TYPE_ID	z ‡
,
‡ ˆ
string
‰ 
ID_PACIENTE
 ›
,
› œ
string
 £
RUT_PACIENTE
¤ °
,
° ±
string
² ¸
TIPO_PACIENTE
¹ Æ
,
Æ Ç
string
È Î
DEATH_INDICATOR
Ï Ş
,
Ş ß
string
à æ
CAT_NAME
ç ï
,
ï ğ
string
ñ ÷
	LAST_NAME
ø 
,
 ‚
string
ƒ ‰

FIRST_NAME
Š ”
,
” •
string
– œ

BIRTH_DATE
 §
,
§ ¨
string
© ¯

GENDER_KEY
° º
,
º »
string
¼ Â
LAST_UPDATED
Ã Ï
,
Ï Ğ
string
Ñ ×
STREET_ADDRESS
Ø æ
,
æ ç
string
è î
CITY
ï ó
,
ó ô
string
õ û
COUNTRY
ü ƒ
,
ƒ „
string
… ‹
PHONE_NUMBER
Œ ˜
,
˜ ™
string
š  
PRIMARY
¡ ¨
,
¨ ©
string
ª °
PATIENT_CLASS_KEY
± Â
)
Â Ã
{ 	
try 
{ 
try 
{ 
string 
	wSqlQuery $
=% &
$str' )
;) *
	wSqlQuery 
= 
$str  "
+# $
$str% S
;S T
using 
( 
OracleConnection +
cnn, /
=0 1
new2 5
OracleConnection6 F
(F G
VariablesGlobalesG X
.X Y

CnnMedisynY c
)c d
)d e
{ 
using 
( 
OracleCommand ,
cmd- 0
=1 2
new3 6
OracleCommand7 D
(D E
	wSqlQueryE N
,N O
cnnP S
)S T
)T U
{ 
cmd 
.  
CommandType  +
=, -
CommandType. 9
.9 :
StoredProcedure: I
;I J
cmd 
.  

Parameters  *
.* +
Add+ .
(. /
new/ 2
OracleParameter3 B
(B C
$strC R
,R S
OracleDbTypeT `
.` a
Int32a f
)f g
)g h
.h i
Valuei n
=o p
COD_EMPRESAr }
;} ~
cmd 
.  

Parameters  *
.* +
Add+ .
(. /
new/ 2
OracleParameter3 B
(B C
$strC S
,S T
OracleDbTypeU a
.a b
Varchar2b j
)j k
)k l
.l m
Valuem r
=s t
COD_SUCURSAL	u 
;
 ‚
cmd 
.  

Parameters  *
.* +
Add+ .
(. /
new/ 2
OracleParameter3 B
(B C
$strC O
,O P
OracleDbTypeQ ]
.] ^
Varchar2^ f
)f g
)g h
.h i
Valuei n
=o p
EVENT_IDq y
;y z
cmd   
.    

Parameters    *
.  * +
Add  + .
(  . /
new  / 2
OracleParameter  3 B
(  B C
$str  C U
,  U V
OracleDbType  W c
.  c d
Date  d h
)  h i
)  i j
.  j k
Value  k p
=  q r
EVENT_DATETIME	  s 
;
   ‚
cmd!! 
.!!  

Parameters!!  *
.!!* +
Add!!+ .
(!!. /
new!!/ 2
OracleParameter!!3 B
(!!B C
$str!!C T
,!!T U
OracleDbType!!V b
.!!b c
Varchar2!!c k
)!!k l
)!!l m
.!!m n
Value!!n s
=!!t u
EVENT_TYPE_ID	!!v ƒ
;
!!ƒ „
cmd"" 
.""  

Parameters""  *
.""* +
Add""+ .
("". /
new""/ 2
OracleParameter""3 B
(""B C
$str""C R
,""R S
OracleDbType""T `
.""` a
Varchar2""a i
)""i j
)""j k
.""k l
Value""l q
=""r s
ID_PACIENTE""t 
;	"" €
cmd## 
.##  

Parameters##  *
.##* +
Add##+ .
(##. /
new##/ 2
OracleParameter##3 B
(##B C
$str##C S
,##S T
OracleDbType##U a
.##a b
	NVarchar2##b k
)##k l
)##l m
.##m n
Value##n s
=##t u
RUT_PACIENTE	##v ‚
;
##‚ ƒ
cmd$$ 
.$$  

Parameters$$  *
.$$* +
Add$$+ .
($$. /
new$$/ 2
OracleParameter$$3 B
($$B C
$str$$C T
,$$T U
OracleDbType$$V b
.$$b c
Varchar2$$c k
)$$k l
)$$l m
.$$m n
Value$$n s
=$$t u
TIPO_PACIENTE	$$v ƒ
;
$$ƒ „
cmd%% 
.%%  

Parameters%%  *
.%%* +
Add%%+ .
(%%. /
new%%/ 2
OracleParameter%%3 B
(%%B C
$str%%C V
,%%V W
OracleDbType%%X d
.%%d e
Varchar2%%e m
)%%m n
)%%n o
.%%o p
Value%%p u
=%%v w
DEATH_INDICATOR	%%x ‡
;
%%‡ ˆ
cmd&& 
.&&  

Parameters&&  *
.&&* +
Add&&+ .
(&&. /
new&&/ 2
OracleParameter&&3 B
(&&B C
$str&&C O
,&&O P
OracleDbType&&Q ]
.&&] ^
Varchar2&&^ f
)&&f g
)&&g h
.&&h i
Value&&i n
=&&o p
CAT_NAME&&q y
;&&y z
cmd'' 
.''  

Parameters''  *
.''* +
Add''+ .
(''. /
new''/ 2
OracleParameter''3 B
(''B C
$str''C P
,''P Q
OracleDbType''R ^
.''^ _
Varchar2''_ g
)''g h
)''h i
.''i j
Value''j o
=''p q
	LAST_NAME''r {
;''{ |
cmd(( 
.((  

Parameters((  *
.((* +
Add((+ .
(((. /
new((/ 2
OracleParameter((3 B
(((B C
$str((C Q
,((Q R
OracleDbType((S _
.((_ `
Varchar2((` h
)((h i
)((i j
.((j k
Value((k p
=((q r

FIRST_NAME((s }
;((} ~
cmd)) 
.))  

Parameters))  *
.))* +
Add))+ .
()). /
new))/ 2
OracleParameter))3 B
())B C
$str))C Q
,))Q R
OracleDbType))S _
.))_ `
Varchar2))` h
)))h i
)))i j
.))j k
Value))k p
=))q r

BIRTH_DATE))s }
;))} ~
cmd** 
.**  

Parameters**  *
.*** +
Add**+ .
(**. /
new**/ 2
OracleParameter**3 B
(**B C
$str**C Q
,**Q R
OracleDbType**S _
.**_ `
Varchar2**` h
)**h i
)**i j
.**j k
Value**k p
=**q r

GENDER_KEY**s }
;**} ~
cmd++ 
.++  

Parameters++  *
.++* +
Add+++ .
(++. /
new++/ 2
OracleParameter++3 B
(++B C
$str++C S
,++S T
OracleDbType++U a
.++a b
Varchar2++b j
)++j k
)++k l
.++l m
Value++m r
=++s t
LAST_UPDATED	++u 
;
++ ‚
cmd,, 
.,,  

Parameters,,  *
.,,* +
Add,,+ .
(,,. /
new,,/ 2
OracleParameter,,3 B
(,,B C
$str,,C U
,,,U V
OracleDbType,,W c
.,,c d
Varchar2,,d l
),,l m
),,m n
.,,n o
Value,,o t
=,,u v
STREET_ADDRESS	,,w …
;
,,… †
cmd-- 
.--  

Parameters--  *
.--* +
Add--+ .
(--. /
new--/ 2
OracleParameter--3 B
(--B C
$str--C K
,--K L
OracleDbType--M Y
.--Y Z
Varchar2--Z b
)--b c
)--c d
.--d e
Value--e j
=--k l
CITY--m q
;--q r
cmd.. 
...  

Parameters..  *
...* +
Add..+ .
(... /
new../ 2
OracleParameter..3 B
(..B C
$str..C N
,..N O
OracleDbType..P \
...\ ]
Varchar2..] e
)..e f
)..f g
...g h
Value..h m
=..n o
COUNTRY..p w
;..w x
cmd// 
.//  

Parameters//  *
.//* +
Add//+ .
(//. /
new/// 2
OracleParameter//3 B
(//B C
$str//C S
,//S T
OracleDbType//U a
.//a b
Varchar2//b j
)//j k
)//k l
.//l m
Value//m r
=//s t
PHONE_NUMBER	//u 
;
// ‚
cmd00 
.00  

Parameters00  *
.00* +
Add00+ .
(00. /
new00/ 2
OracleParameter003 B
(00B C
$str00C N
,00N O
OracleDbType00P \
.00\ ]
Varchar200] e
)00e f
)00f g
.00g h
Value00h m
=00n o
PRIMARY00p w
;00w x
cmd11 
.11  

Parameters11  *
.11* +
Add11+ .
(11. /
new11/ 2
OracleParameter113 B
(11B C
$str11C X
,11X Y
OracleDbType11Z f
.11f g
Varchar211g o
)11o p
)11p q
.11q r
Value11r w
=11x y
PATIENT_CLASS_KEY	11z ‹
;
11‹ Œ
cnn33 
.33  
Open33  $
(33$ %
)33% &
;33& '
OracleDataAdapter44 -
da44. 0
=441 2
new443 6
OracleDataAdapter447 H
(44H I
cmd44I L
)44L M
;44M N
try55 
{66 
DataSet77  '
ds77( *
=77+ ,
new77- 0
DataSet771 8
(778 9
)779 :
;77: ;
da88  "
.88" #
Fill88# '
(88' (
ds88( *
)88* +
;88+ ,
return99  &
$str99' 2
;992 3
}:: 
catch;; !
(;;" #
	Exception;;# ,
ex;;- /
);;/ 0
{<< 
return==  &
$str==' \
+==] ^
ex==_ a
.==a b
Message==b i
;==i j
}>> 
}?? 
}@@ 
}AA 
catchBB 
(BB 
	ExceptionBB  
exBB! #
)BB# $
{CC 
throwDD 
newDD 
	ExceptionDD '
(DD' (
$strDD( F
+DDG H
exDDI K
.DDK L
MessageDDL S
)DDS T
;DDT U
}EE 
}FF 
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG  
{HH 
returnII 
$strII /
+II0 1
exII2 4
.II4 5
MessageII5 <
;II< =
}JJ 
}KK 	
}LL 
}MM •'
aD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\MedisynAD\CorreosAD\GenEnvioMailAD.cs
	namespace 	
Dat
 
. 
Oracle 
. 
	MedisynAD 
. 
	CorreosAD (
{ 
public 

class 
GenEnvioMailAD 
{ 
private 
GenEnvioMailE 
LlenarEntidad +
(+ ,
IDataReader, 7
dr8 :
): ;
{ 	
GenEnvioMailE 
oGenEnvioMailE (
=) *
new+ .
GenEnvioMailE/ <
(< =
)= >
;> ?
oGenEnvioMailE 
. 
IdMail !
=" #
($ %
string% +
)+ ,
dr, .
[. /
$str/ 8
]8 9
;9 :
oGenEnvioMailE 
. 
MailTo !
=" #
($ %
string% +
)+ ,
dr, .
[. /
$str/ 8
]8 9
;9 :
oGenEnvioMailE 
. 
MailCC !
=" #
($ %
string% +
)+ ,
dr, .
[. /
$str/ 8
]8 9
;9 :
oGenEnvioMailE 
. 
MailBody #
=$ %
(& '
string' -
)- .
dr. 0
[0 1
$str1 <
]< =
;= >
oGenEnvioMailE 
. 

MailSubjet %
=& '
(( )
string) /
)/ 0
dr0 2
[2 3
$str3 @
]@ A
;A B
return 
oGenEnvioMailE !
;! "
} 	
public 
List 
< 
GenEnvioMailE !
>! "
ConsultarEnvioMail# 5
(5 6
ref6 9
int: =
IdMailUltimo> J
)J K
{ 	
IDataReader 
dr 
; 
List 
< 
GenEnvioMailE 
> 
ListGenEnvioMailE  1
=2 3
new4 7
List8 <
<< =
GenEnvioMailE= J
>J K
(K L
)L M
;M N
string   
	wSqlQuery   
=   
$str   !
;  ! "
try"" 
{## 
	wSqlQuery$$ 
=$$ 
$str$$ 
+$$  
$str$$! a
+$$b c
$str	$$d Ó
+
$$Ô Õ
$str
$$Ö î
+
$$ï ğ
$str
$$ñ 
+
$$ Ÿ
IdMailUltimo
$$  ¬
.
$$¬ ­
ToString
$$­ µ
(
$$µ ¶
)
$$¶ ·
+
$$¸ ¹
$str
$$º ½
+
$$¾ ¿
$str
$$À ì
;
$$ì í
using&& 
(&& 
OracleConnection&& '
cnn&&( +
=&&, -
new&&. 1
OracleConnection&&2 B
(&&B C
VariablesGlobales&&C T
.&&T U

CnnMedisyn&&U _
)&&_ `
)&&` a
{'' 
using(( 
((( 
OracleCommand(( (
cmd(() ,
=((- .
new((/ 2
OracleCommand((3 @
(((@ A
	wSqlQuery((A J
,((J K
cnn((L O
)((O P
)((P Q
{)) 
cmd** 
.** 
CommandType** '
=**( )
CommandType*** 5
.**5 6
Text**6 :
;**: ;
cnn++ 
.++ 
Open++  
(++  !
)++! "
;++" #
dr,, 
=,, 
cmd,,  
.,,  !
ExecuteReader,,! .
(,,. /
),,/ 0
;,,0 1
while-- 
(-- 
dr-- !
.--! "
Read--" &
(--& '
)--' (
)--( )
ListGenEnvioMailE.. -
...- .
Add... 1
(..1 2
LlenarEntidad..2 ?
(..? @
dr..@ B
)..B C
)..C D
;..D E
dr// 
.// 
Dispose// "
(//" #
)//# $
;//$ %
dr00 
.00 
Close00  
(00  !
)00! "
;00" #
cmd11 
.11 
Dispose11 #
(11# $
)11$ %
;11% &
cnn22 
.22 
Dispose22 #
(22# $
)22$ %
;22% &
cnn33 
.33 
Close33 !
(33! "
)33" #
;33# $
}44 
}55 
}66 
catch77 
(77 
	Exception77 
ex77 
)77  
{88 
throw99 
new99 
	Exception99 #
(99# $
$str99$ K
+99L M
ex99N P
.99P Q
Message99Q X
)99X Y
;99Y Z
}:: 
return;; 
ListGenEnvioMailE;; $
;;;$ %
}<< 	
}== 
}>> 