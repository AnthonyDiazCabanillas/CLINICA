±
PD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\VariablesGlobales.cs
	namespace 	
Dat
 
. 
Oracle 
{ 
public 

static 
class 
VariablesGlobales )
{ 
public		 
static		 
string		 

CnnMedisyn		 '
=		( )
$str		* ,
;		, -
}

 
} €„
_D:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\MedisynAD\ReservasAD\AmReservaAD.cs
	namespace 	
Dat
 
. 
Oracle 
. 
	MedisynAD 
. 

ReservasAD )
{ 
public 

class 
AmReservaAD 
{ 
private 

AmReservaE 
LlenarEntidad (
(( )
IDataReader) 4
dr5 7
,7 8
int9 <
pOrden= C
=D E
$numF G
)G H
{ 	

AmReservaE 
oAmReservaE "
=# $
new% (

AmReservaE) 3
(3 4
)4 5
;5 6
switch 
( 
pOrden 
) 
{ 
case 
$num 
: 
{ 
oAmReservaE #
.# $
IdCorrelReserva$ 3
=4 5
(6 7
string7 =
)= >
dr> @
[@ A
$strA Q
]Q R
;R S
oAmReservaE #
.# $
FecIngresoReserva$ 5
=6 7
(8 9
DateTime9 A
)A B
drB D
[D E
$strE U
]U V
;V W
oAmReservaE #
.# $

FecReserva$ .
=/ 0
Convert1 8
.8 9

ToDateTime9 C
(C D
(D E
stringE K
)K L
drL N
[N O
$strO ^
]^ _
+` a
$strb e
+f g
(h i
stringi o
)o p
drp r
[r s
$str	s Å
]
Å Ç
)
Ç É
;
É Ñ
oAmReservaE #
.# $

IdPaciente$ .
=/ 0
(1 2
int2 5
)5 6
dr6 8
[8 9
$str9 F
]F G
;G H
oAmReservaE #
.# $
IdPacienteReserva$ 5
=6 7
(8 9
int9 <
)< =
dr= ?
[? @
$str@ U
]U V
;V W
oAmReservaE #
.# $
CodEspecialidad$ 3
=4 5
(6 7
int7 :
): ;
dr; =
[= >
$str> P
]P Q
;Q R
oAmReservaE #
.# $
CodSucursal$ /
=0 1
(2 3
int3 6
)6 7
dr7 9
[9 :
$str: H
]H I
;I J
oAmReservaE #
.# $
Medico$ *
=+ ,
(- .
string. 4
)4 5
dr5 7
[7 8
$str8 @
]@ A
;A B
oAmReservaE   #
.  # $
EmailPaciente  $ 1
=  2 3
(  4 5
string  5 ;
)  ; <
dr  < >
[  > ?
$str  ? O
]  O P
;  P Q
break!! 
;!! 
}"" 
case$$ 
$num$$ 
:$$ 
{%% 
oAmReservaE&& #
.&&# $

BoxReserva&&$ .
=&&/ 0
dr&&1 3
[&&3 4
$str&&4 A
]&&A B
+&&C D
$str&&E G
;&&G H
oAmReservaE'' #
.''# $
	CodUnidad''$ -
=''. /
dr''0 2
[''2 3
$str''3 ?
]''? @
+''A B
$str''C E
;''E F
oAmReservaE(( #
.((# $

DescUnidad(($ .
=((/ 0
dr((1 3
[((3 4
$str((4 A
]((A B
+((C D
$str((E G
;((G H
break)) 
;)) 
}** 
case,, 
$num,, 
:,, 
{-- 
oAmReservaE.. #
...# $
CodProf..$ +
=.., -
dr... 0
[..0 1
$str..1 ;
]..; <
+..= >
$str..? A
;..A B
oAmReservaE// #
.//# $
IdAmbulatorio//$ 1
=//2 3
dr//4 6
[//6 7
$str//7 G
]//G H
+//I J
$str//K M
;//M N
oAmReservaE00 #
.00# $
IdCorrelReserva00$ 3
=004 5
dr006 8
[008 9
$str009 I
]00I J
+00K L
$str00M O
;00O P
oAmReservaE11 #
.11# $
CodEspecialidad11$ 3
=114 5
(116 7
int117 :
)11: ;
dr11; =
[11= >
$str11> P
]11P Q
;11Q R
oAmReservaE33 #
.33# $
RutPaciente33$ /
=330 1
(332 3
$str333 7
+338 9
(33: ;
dr33; =
[33= >
$str33> L
]33L M
+33N O
$str33P R
)33R S
)33S T
;33T U
oAmReservaE44 #
.44# $
RutPaciente44$ /
=440 1
oAmReservaE442 =
.44= >
RutPaciente44> I
.44I J
	Substring44J S
(44S T
oAmReservaE44T _
.44_ `
RutPaciente44` k
.44k l
Length44l r
-44s t
$num44u v
,44v w
$num44x y
)44y z
;44z {
oAmReservaE66 #
.66# $

FecReserva66$ .
=66/ 0
(661 2
DateTime662 :
)66: ;
dr66; =
[66= >
$str66> M
]66M N
;66N O
oAmReservaE77 #
.77# $
HoraReserva77$ /
=770 1
(772 3
DateTime773 ;
)77; <
dr77< >
[77> ?
$str77? M
]77M N
;77N O
oAmReservaE88 #
.88# $
CodSucursal88$ /
=880 1
(882 3
int883 6
)886 7
dr887 9
[889 :
$str88: H
]88H I
;88I J
oAmReservaE99 #
.99# $
DscSucursal99$ /
=990 1
(992 3
string993 9
)999 :
dr99: <
[99< =
$str99= K
]99K L
;99L M
break:: 
;:: 
};; 
}<< 
return>> 
oAmReservaE>> 
;>> 
}?? 	
publicAA 
ListAA 
<AA 

AmReservaEAA 
>AA &
ConsultarReservasPacientesAA  :
(AA: ;
refAA; >
intAA? B
CodReservaUltimoAAC S
)AAS T
{BB 	
IDataReaderCC 
drCC 
;CC 

AmReservaEDD 
objAmReservaEDD $
=DD% &
newDD' *

AmReservaEDD+ 5
(DD5 6
)DD6 7
;DD7 8
ListEE 
<EE 

AmReservaEEE 
>EE 
ListReservaEEE )
=EE* +
newEE, /
ListEE0 4
<EE4 5

AmReservaEEE5 ?
>EE? @
(EE@ A
)EEA B
;EEB C
stringFF 
	wSqlQueryFF 
=FF 
$strFF !
;FF! "
tryHH 
{II 
	wSqlQueryJJ 
=JJ 
$strJJ 
+JJ  
$strJJ! )
+JJ* +
$strJJ, @
+JJA B
$strJJC W
+JJX Y
$strJJZ m
+JJn o
$str	JJp Ç
+
JJÉ Ñ
$str
JJÖ ñ
+
JJó ò
$str
JJô ≤
+
JJ≥ ¥
$str
JJµ …
+
JJ  À
$str
JJÃ ‚
+
JJ„ ‰
$str
JJÂ √
+
JJƒ ≈
$str
JJ∆ ÿ
+
JJŸ ⁄
$str
JJ€ ˙
+
JJ˚ ¸
$str
JJ˝ À
+
JJÃ Õ
$str
JJŒ à
+
JJâ ä
$str
JJã ¶
+
JJß ®
CodReservaUltimo
JJ© π
.
JJπ ∫
ToString
JJ∫ ¬
(
JJ¬ √
)
JJ√ ƒ
+
JJ≈ ∆
$str
JJ« „
+
JJ‰ Â
$str
JJÊ Å
;
JJÅ Ç
usingLL 
(LL 
OracleConnectionLL '
cnnLL( +
=LL, -
newLL. 1
OracleConnectionLL2 B
(LLB C
VariablesGlobalesLLC T
.LLT U

CnnMedisynLLU _
)LL_ `
)LL` a
{MM 
usingNN 
(NN 
OracleCommandNN (
cmdNN) ,
=NN- .
newNN/ 2
OracleCommandNN3 @
(NN@ A
	wSqlQueryNNA J
,NNJ K
cnnNNL O
)NNO P
)NNP Q
{OO 
cmdPP 
.PP 
CommandTypePP '
=PP( )
CommandTypePP* 5
.PP5 6
TextPP6 :
;PP: ;
cnnQQ 
.QQ 
OpenQQ  
(QQ  !
)QQ! "
;QQ" #
drRR 
=RR 
cmdRR  
.RR  !
ExecuteReaderRR! .
(RR. /
)RR/ 0
;RR0 1
whileSS 
(SS 
drSS !
.SS! "
ReadSS" &
(SS& '
)SS' (
)SS( )
ListReservaETT (
.TT( )
AddTT) ,
(TT, -
LlenarEntidadTT- :
(TT: ;
drTT; =
)TT= >
)TT> ?
;TT? @
cmdUU 
.UU 
DisposeUU #
(UU# $
)UU$ %
;UU% &
cnnVV 
.VV 
DisposeVV #
(VV# $
)VV$ %
;VV% &
cnnWW 
.WW 
CloseWW !
(WW! "
)WW" #
;WW# $
}XX 
}YY 
}ZZ 
catch[[ 
([[ 
	Exception[[ 
ex[[ 
)[[  
{\\ 
throw]] 
new]] 
	Exception]] #
(]]# $
$str]]$ B
+]]C D
ex]]E G
.]]G H
Message]]H O
)]]O P
;]]P Q
}^^ 
return__ 
ListReservaE__ 
;__  
}`` 	
publicbb 
Listbb 
<bb 

AmReservaEbb 
>bb &
ConsultarReservaPacienteIdbb  :
(bb: ;
stringbb; A
CorrelReservabbB O
)bbO P
{cc 	
IDataReaderdd 
drdd 
;dd 

AmReservaEee 
objAmReservaEee $
=ee% &
newee' *

AmReservaEee+ 5
(ee5 6
)ee6 7
;ee7 8
Listff 
<ff 

AmReservaEff 
>ff 
ListReservaEff )
=ff* +
newff, /
Listff0 4
<ff4 5

AmReservaEff5 ?
>ff? @
(ff@ A
)ffA B
;ffB C
stringgg 
	wSqlQuerygg 
=gg 
$strgg !
;gg! "
tryii 
{jj 
	wSqlQuerykk 
=kk 
$strkk 
+kk  
$strkk! j
+kkk l
$str	kkm Å
+
kkÇ É
$str
kkÑ ∏
+
kkπ ∫
$str
kkª ı
+
kkˆ ˜
$str
kk¯ ì
+
kkî ï
CorrelReserva
kkñ £
+
kk§ •
$str
kk¶ ®
;
kk® ©
usingmm 
(mm 
OracleConnectionmm '
cnnmm( +
=mm, -
newmm. 1
OracleConnectionmm2 B
(mmB C
VariablesGlobalesmmC T
.mmT U

CnnMedisynmmU _
)mm_ `
)mm` a
{nn 
usingoo 
(oo 
OracleCommandoo (
cmdoo) ,
=oo- .
newoo/ 2
OracleCommandoo3 @
(oo@ A
	wSqlQueryooA J
,ooJ K
cnnooL O
)ooO P
)ooP Q
{pp 
cmdqq 
.qq 
CommandTypeqq '
=qq( )
CommandTypeqq* 5
.qq5 6
Textqq6 :
;qq: ;
cnnrr 
.rr 
Openrr  
(rr  !
)rr! "
;rr" #
drss 
=ss 
cmdss  
.ss  !
ExecuteReaderss! .
(ss. /
)ss/ 0
;ss0 1
whilett 
(tt 
drtt !
.tt! "
Readtt" &
(tt& '
)tt' (
)tt( )
ListReservaEuu (
.uu( )
Adduu) ,
(uu, -
LlenarEntidaduu- :
(uu: ;
druu; =
,uu= >
$numuu? @
)uu@ A
)uuA B
;uuB C
cmdvv 
.vv 
Disposevv #
(vv# $
)vv$ %
;vv% &
cnnww 
.ww 
Disposeww #
(ww# $
)ww$ %
;ww% &
cnnxx 
.xx 
Closexx !
(xx! "
)xx" #
;xx# $
}yy 
}zz 
}{{ 
catch|| 
(|| 
	Exception|| 
ex|| 
)||  
{}} 
throw~~ 
new~~ 
	Exception~~ #
(~~# $
$str~~$ B
+~~C D
ex~~E G
.~~G H
Message~~H O
)~~O P
;~~P Q
} 
return
ÄÄ 
ListReservaE
ÄÄ 
;
ÄÄ  
}
ÅÅ 	
public
ÑÑ 

AmReservaE
ÑÑ  
ObtenerInfoReserva
ÑÑ ,
(
ÑÑ, -

AmReservaE
ÑÑ- 7
pObjAmReserva
ÑÑ8 E
)
ÑÑE F
{
ÖÖ 	
IDataReader
ÜÜ 
dr
ÜÜ 
;
ÜÜ 

AmReservaE
áá 
objGenEnvioMailE
áá '
=
áá( )
new
áá* -

AmReservaE
áá. 8
(
áá8 9
)
áá9 :
;
áá: ;
string
àà 
	wSqlQuery
àà 
=
àà 
$str
àà !
;
àà! "
try
ää 
{
ãã 
	wSqlQuery
åå 
=
åå 
$str
åå %
+
åå& '
$str
åå( ~
+åå Ä
$strååÅ Œ
+ååœ –
$stråå— Â
+ååÊ Á
$strååË ´
+åå¨ ≠
$strååÆ ˝
+åå˛ ˇ
$strååÄ ú
+ååù û
pObjAmReservaååü ¨
.åå¨ ≠
IdCorrelReservaåå≠ º
+ååΩ æ
$strååø ¬
;åå¬ √
using
éé 
(
éé 
OracleConnection
éé '
cnn
éé( +
=
éé, -
new
éé. 1
OracleConnection
éé2 B
(
ééB C
VariablesGlobales
ééC T
.
ééT U

CnnMedisyn
ééU _
)
éé_ `
)
éé` a
{
èè 
using
êê 
(
êê 
OracleCommand
êê (
cmd
êê) ,
=
êê- .
new
êê/ 2
OracleCommand
êê3 @
(
êê@ A
	wSqlQuery
êêA J
,
êêJ K
cnn
êêL O
)
êêO P
)
êêP Q
{
ëë 
cmd
íí 
.
íí 
CommandType
íí '
=
íí( )
CommandType
íí* 5
.
íí5 6
Text
íí6 :
;
íí: ;
cnn
ìì 
.
ìì 
Open
ìì  
(
ìì  !
)
ìì! "
;
ìì" #
dr
îî 
=
îî 
cmd
îî  
.
îî  !
ExecuteReader
îî! .
(
îî. /
)
îî/ 0
;
îî0 1
while
ïï 
(
ïï 
dr
ïï !
.
ïï! "
Read
ïï" &
(
ïï& '
)
ïï' (
)
ïï( )
objGenEnvioMailE
ññ ,
=
ññ- .
LlenarEntidad
ññ/ <
(
ññ< =
dr
ññ= ?
,
ññ? @
pObjAmReserva
ññA N
.
ññN O
ORDEN
ññO T
)
ññT U
;
ññU V
dr
óó 
.
óó 
Dispose
óó "
(
óó" #
)
óó# $
;
óó$ %
dr
òò 
.
òò 
Close
òò  
(
òò  !
)
òò! "
;
òò" #
cmd
ôô 
.
ôô 
Dispose
ôô #
(
ôô# $
)
ôô$ %
;
ôô% &
cnn
öö 
.
öö 
Dispose
öö #
(
öö# $
)
öö$ %
;
öö% &
cnn
õõ 
.
õõ 
Close
õõ !
(
õõ! "
)
õõ" #
;
õõ# $
}
úú 
}
ùù 
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
†† 
throw
°° 
new
°° 
	Exception
°° #
(
°°# $
$str
°°$ R
+
°°S T
ex
°°U W
.
°°W X
Message
°°X _
)
°°_ `
;
°°` a
}
¢¢ 
return
§§ 
objGenEnvioMailE
§§ #
;
§§# $
}
•• 	
public
¨¨ 
bool
¨¨ ,
VerificarCitaPacienteMedicoDia
¨¨ 2
(
¨¨2 3

AmReservaE
¨¨3 =
pObjAmReserva
¨¨> K
)
¨¨K L
{
≠≠ 	
bool
ÆÆ 
result
ÆÆ 
=
ÆÆ 
false
ÆÆ 
;
ÆÆ  
try
∞∞ 
{
±± 
using
≤≤ 
(
≤≤ 
OracleConnection
≤≤ '
cnn
≤≤( +
=
≤≤, -
new
≤≤. 1
OracleConnection
≤≤2 B
(
≤≤B C
VariablesGlobales
≤≤C T
.
≤≤T U

CnnMedisyn
≤≤U _
)
≤≤_ `
)
≤≤` a
{
≥≥ 
using
¥¥ 
(
¥¥ 
OracleCommand
¥¥ (
cmd
¥¥) ,
=
¥¥- .
new
¥¥/ 2
OracleCommand
¥¥3 @
(
¥¥@ A
$str
¥¥A v
,
¥¥v w
cnn
¥¥x {
)
¥¥{ |
)
¥¥| }
{
µµ 
cnn
∂∂ 
.
∂∂ 
Open
∂∂  
(
∂∂  !
)
∂∂! "
;
∂∂" #
cmd
∑∑ 
.
∑∑ 
CommandType
∑∑ '
=
∑∑( )
CommandType
∑∑* 5
.
∑∑5 6
StoredProcedure
∑∑6 E
;
∑∑E F
cmd
ππ 
.
ππ 

Parameters
ππ &
.
ππ& '
Add
ππ' *
(
ππ* +
$str
ππ+ ?
,
ππ? @
OracleDbType
ππA M
.
ππM N
Int64
ππN S
)
ππS T
.
ππT U
Value
ππU Z
=
ππ[ \
pObjAmReserva
ππ] j
.
ππj k
IdAmbulatorio
ππk x
;
ππx y
cmd
∫∫ 
.
∫∫ 

Parameters
∫∫ &
.
∫∫& '
Add
∫∫' *
(
∫∫* +
$str
∫∫+ >
,
∫∫> ?
OracleDbType
∫∫@ L
.
∫∫L M
	NVarchar2
∫∫M V
)
∫∫V W
.
∫∫W X
Value
∫∫X ]
=
∫∫^ _
pObjAmReserva
∫∫` m
.
∫∫m n
FecReserva_String
∫∫n 
;∫∫ Ä
cmd
ªª 
.
ªª 

Parameters
ªª &
.
ªª& '
Add
ªª' *
(
ªª* +
$str
ªª+ ?
,
ªª? @
OracleDbType
ªªA M
.
ªªM N
Int64
ªªN S
)
ªªS T
.
ªªT U
Value
ªªU Z
=
ªª[ \
pObjAmReserva
ªª] j
.
ªªj k
CorrelHorario
ªªk x
;
ªªx y
cmd
ºº 
.
ºº 

Parameters
ºº &
.
ºº& '
Add
ºº' *
(
ºº* +
$str
ºº+ ;
,
ºº; <
OracleDbType
ºº= I
.
ººI J
	RefCursor
ººJ S
,
ººS T 
ParameterDirection
ººU g
.
ººg h
Output
ººh n
)
ººn o
;
ººo p
IDataReader
ΩΩ #
dr
ΩΩ$ &
=
ΩΩ' (
cmd
ΩΩ) ,
.
ΩΩ, -
ExecuteReader
ΩΩ- :
(
ΩΩ: ;
)
ΩΩ; <
;
ΩΩ< =
while
øø 
(
øø 
dr
øø !
.
øø! "
Read
øø" &
(
øø& '
)
øø' (
)
øø( )
result
¿¿ "
=
¿¿# $
true
¿¿% )
;
¿¿) *
dr
¬¬ 
.
¬¬ 
Dispose
¬¬ "
(
¬¬" #
)
¬¬# $
;
¬¬$ %
dr
√√ 
.
√√ 
Close
√√  
(
√√  !
)
√√! "
;
√√" #
cmd
ƒƒ 
.
ƒƒ 
Dispose
ƒƒ #
(
ƒƒ# $
)
ƒƒ$ %
;
ƒƒ% &
}
≈≈ 
cnn
«« 
.
«« 
Dispose
«« 
(
««  
)
««  !
;
««! "
cnn
»» 
.
»» 
Close
»» 
(
»» 
)
»» 
;
»»  
}
…… 
}
   
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÃÃ 
throw
ÕÕ 
new
ÕÕ 
	Exception
ÕÕ #
(
ÕÕ# $
$str
ÕÕ$ ^
+
ÕÕ_ `
ex
ÕÕa c
.
ÕÕc d
Message
ÕÕd k
)
ÕÕk l
;
ÕÕl m
}
ŒŒ 
return
–– 
result
–– 
;
–– 
}
—— 	
public
◊◊ 
List
◊◊ 
<
◊◊ 
AgendaDatos
◊◊ 
>
◊◊  $
ObtieneAgendaXApellido
◊◊! 7
(
◊◊7 8
int
◊◊8 ;
Cod_Empresa
◊◊< G
,
◊◊G H
int
◊◊I L
Cod_Sucursal
◊◊M Y
,
◊◊Y Z
string
◊◊[ a
ApelPat_prof
◊◊b n
)
◊◊n o
{
ÿÿ 	
var
ŸŸ 
oList
ŸŸ 
=
ŸŸ 
new
ŸŸ 
List
ŸŸ  
<
ŸŸ  !
AgendaDatos
ŸŸ! ,
>
ŸŸ, -
(
ŸŸ- .
)
ŸŸ. /
;
ŸŸ/ 0
try
€€ 
{
‹‹ 
using
›› 
(
›› 
OracleConnection
›› '
cnn
››( +
=
››, -
new
››. 1
OracleConnection
››2 B
(
››B C
VariablesGlobales
››C T
.
››T U

CnnMedisyn
››U _
)
››_ `
)
››` a
{
ﬁﬁ 
using
ﬂﬂ 
(
ﬂﬂ 
OracleCommand
ﬂﬂ (
cmd
ﬂﬂ) ,
=
ﬂﬂ- .
new
ﬂﬂ/ 2
OracleCommand
ﬂﬂ3 @
(
ﬂﬂ@ A
$str
ﬂﬂA d
,
ﬂﬂd e
cnn
ﬂﬂf i
)
ﬂﬂi j
)
ﬂﬂj k
{
‡‡ 
cnn
·· 
.
·· 
Open
··  
(
··  !
)
··! "
;
··" #
cmd
‚‚ 
.
‚‚ 
CommandType
‚‚ '
=
‚‚( )
CommandType
‚‚* 5
.
‚‚5 6
StoredProcedure
‚‚6 E
;
‚‚E F
cmd
‰‰ 
.
‰‰ 

Parameters
‰‰ &
.
‰‰& '
Add
‰‰' *
(
‰‰* +
$str
‰‰+ ;
,
‰‰; <
OracleDbType
‰‰= I
.
‰‰I J
Int64
‰‰J O
)
‰‰O P
.
‰‰P Q
Value
‰‰Q V
=
‰‰W X
Cod_Empresa
‰‰Y d
;
‰‰d e
cmd
ÂÂ 
.
ÂÂ 

Parameters
ÂÂ &
.
ÂÂ& '
Add
ÂÂ' *
(
ÂÂ* +
$str
ÂÂ+ <
,
ÂÂ< =
OracleDbType
ÂÂ> J
.
ÂÂJ K
Int64
ÂÂK P
)
ÂÂP Q
.
ÂÂQ R
Value
ÂÂR W
=
ÂÂX Y
Cod_Sucursal
ÂÂZ f
;
ÂÂf g
cmd
ÊÊ 
.
ÊÊ 

Parameters
ÊÊ &
.
ÊÊ& '
Add
ÊÊ' *
(
ÊÊ* +
$str
ÊÊ+ ;
,
ÊÊ; <
OracleDbType
ÊÊ= I
.
ÊÊI J
	NVarchar2
ÊÊJ S
)
ÊÊS T
.
ÊÊT U
Value
ÊÊU Z
=
ÊÊ[ \
ApelPat_prof
ÊÊ] i
;
ÊÊi j
cmd
ÁÁ 
.
ÁÁ 

Parameters
ÁÁ &
.
ÁÁ& '
Add
ÁÁ' *
(
ÁÁ* +
$str
ÁÁ+ 4
,
ÁÁ4 5
OracleDbType
ÁÁ6 B
.
ÁÁB C
	RefCursor
ÁÁC L
,
ÁÁL M 
ParameterDirection
ÁÁN `
.
ÁÁ` a
Output
ÁÁa g
)
ÁÁg h
;
ÁÁh i
IDataReader
ÈÈ #
dr
ÈÈ$ &
=
ÈÈ' (
cmd
ÈÈ) ,
.
ÈÈ, -
ExecuteReader
ÈÈ- :
(
ÈÈ: ;
)
ÈÈ; <
;
ÈÈ< =
var
ÍÍ 
obj
ÍÍ 
=
ÍÍ  !
new
ÍÍ" %
AgendaDatos
ÍÍ& 1
(
ÍÍ1 2
)
ÍÍ2 3
;
ÍÍ3 4
while
ÎÎ 
(
ÎÎ 
dr
ÎÎ !
.
ÎÎ! "
Read
ÎÎ" &
(
ÎÎ& '
)
ÎÎ' (
)
ÎÎ( )
{
ÏÏ 
obj
ÌÌ 
=
ÌÌ  !
new
ÌÌ" %
AgendaDatos
ÌÌ& 1
(
ÌÌ1 2
)
ÌÌ2 3
;
ÌÌ3 4
obj
ÓÓ 
.
ÓÓ  
cOD_SUCURSAL
ÓÓ  ,
=
ÓÓ- .
(
ÓÓ/ 0
byte
ÓÓ0 4
)
ÓÓ4 5
dr
ÓÓ5 7
[
ÓÓ7 8
$str
ÓÓ8 F
]
ÓÓF G
;
ÓÓG H
obj
ÔÔ 
.
ÔÔ  
sUCURSAL
ÔÔ  (
=
ÔÔ) *
(
ÔÔ+ ,
string
ÔÔ, 2
)
ÔÔ2 3
dr
ÔÔ3 5
[
ÔÔ5 6
$str
ÔÔ6 @
]
ÔÔ@ A
;
ÔÔA B
obj
 
.
  
cOD_PROF
  (
=
) *
(
+ ,
ushort
, 2
)
2 3
dr
3 5
[
5 6
$str
6 @
]
@ A
;
A B
obj
ÒÒ 
.
ÒÒ  
rUT_PROF
ÒÒ  (
=
ÒÒ) *
(
ÒÒ+ ,
uint
ÒÒ, 0
)
ÒÒ0 1
dr
ÒÒ1 3
[
ÒÒ3 4
$str
ÒÒ4 >
]
ÒÒ> ?
;
ÒÒ? @
obj
ÚÚ 
.
ÚÚ  
aPEPAT_PROF
ÚÚ  +
=
ÚÚ, -
(
ÚÚ. /
string
ÚÚ/ 5
)
ÚÚ5 6
dr
ÚÚ6 8
[
ÚÚ8 9
$str
ÚÚ9 F
]
ÚÚF G
;
ÚÚG H
obj
ÛÛ 
.
ÛÛ  
aPEMAT_PROF
ÛÛ  +
=
ÛÛ, -
(
ÛÛ. /
string
ÛÛ/ 5
)
ÛÛ5 6
dr
ÛÛ6 8
[
ÛÛ8 9
$str
ÛÛ9 F
]
ÛÛF G
;
ÛÛG H
obj
ÙÙ 
.
ÙÙ  
nOMBRE1_PROF
ÙÙ  ,
=
ÙÙ- .
(
ÙÙ/ 0
string
ÙÙ0 6
)
ÙÙ6 7
dr
ÙÙ7 9
[
ÙÙ9 :
$str
ÙÙ: H
]
ÙÙH I
;
ÙÙI J
obj
ıı 
.
ıı  
cOD_ESPECIALIDAD
ıı  0
=
ıı1 2
(
ıı3 4
byte
ıı4 8
)
ıı8 9
dr
ıı9 ;
[
ıı; <
$str
ıı< N
]
ııN O
;
ııO P
obj
ˆˆ 
.
ˆˆ  
	dESC_ITEM
ˆˆ  )
=
ˆˆ* +
(
ˆˆ, -
string
ˆˆ- 3
)
ˆˆ3 4
dr
ˆˆ4 6
[
ˆˆ6 7
$str
ˆˆ7 B
]
ˆˆB C
;
ˆˆC D
obj
˜˜ 
.
˜˜  

cORRAGENDA
˜˜  *
=
˜˜+ ,
(
˜˜- .
ushort
˜˜. 4
)
˜˜4 5
dr
˜˜5 7
[
˜˜7 8
$str
˜˜8 D
]
˜˜D E
;
˜˜E F
obj
¯¯ 
.
¯¯  "
fECHAINICPROX_AGENDA
¯¯  4
=
¯¯5 6
(
¯¯7 8
string
¯¯8 >
)
¯¯> ?
dr
¯¯? A
[
¯¯A B
$str
¯¯B X
]
¯¯X Y
;
¯¯Y Z
obj
˘˘ 
.
˘˘  
fECHA_SISTEMA
˘˘  -
=
˘˘. /
(
˘˘0 1
string
˘˘1 7
)
˘˘7 8
dr
˘˘8 :
[
˘˘: ;
$str
˘˘; J
]
˘˘J K
;
˘˘K L
obj
˙˙ 
.
˙˙  

cOD_UNIDAD
˙˙  *
=
˙˙+ ,
(
˙˙- .
byte
˙˙. 2
)
˙˙2 3
dr
˙˙3 5
[
˙˙5 6
$str
˙˙6 B
]
˙˙B C
;
˙˙C D
obj
˚˚ 
.
˚˚  
dESC_UNIDAD
˚˚  +
=
˚˚, -
(
˚˚. /
string
˚˚/ 5
)
˚˚5 6
dr
˚˚6 8
[
˚˚8 9
$str
˚˚9 F
]
˚˚F G
;
˚˚G H
obj
¸¸ 
.
¸¸  
hMUL
¸¸  $
=
¸¸% &
(
¸¸' (
byte
¸¸( ,
)
¸¸, -
dr
¸¸- /
[
¸¸/ 0
$str
¸¸0 6
]
¸¸6 7
;
¸¸7 8
obj
˝˝ 
.
˝˝  
vERSTAFF
˝˝  (
=
˝˝) *
(
˝˝+ ,
string
˝˝, 2
)
˝˝2 3
dr
˝˝3 5
[
˝˝5 6
$str
˝˝6 @
]
˝˝@ A
;
˝˝A B
obj
˛˛ 
.
˛˛  %
pROXIMA_HORA_DISPONIBLE
˛˛  7
=
˛˛8 9
(
˛˛: ;
DateTime
˛˛; C
)
˛˛C D
dr
˛˛D F
[
˛˛F G
$str
˛˛G `
]
˛˛` a
;
˛˛a b
obj
ˇˇ 
.
ˇˇ  *
pROXIMA_HORA_DISPONIBLE_CHAR
ˇˇ  <
=
ˇˇ= >
(
ˇˇ? @
string
ˇˇ@ F
)
ˇˇF G
dr
ˇˇG I
[
ˇˇI J
$str
ˇˇJ h
]
ˇˇh i
;
ˇˇi j
oList
õõ !
.
õõ! "
Add
õõ" %
(
õõ% &
obj
õõ& )
)
õõ) *
;
õõ* +
}
úú 
dr
ûû 
.
ûû 
Dispose
ûû "
(
ûû" #
)
ûû# $
;
ûû$ %
dr
üü 
.
üü 
Close
üü  
(
üü  !
)
üü! "
;
üü" #
cmd
†† 
.
†† 
Dispose
†† #
(
††# $
)
††$ %
;
††% &
}
°° 
cnn
££ 
.
££ 
Dispose
££ 
(
££  
)
££  !
;
££! "
cnn
§§ 
.
§§ 
Close
§§ 
(
§§ 
)
§§ 
;
§§  
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
	Exception
ßß 
ex
ßß 
)
ßß  
{
®® 
throw
©© 
new
©© 
	Exception
©© #
(
©©# $
$str
©©$ V
+
©©W X
ex
©©Y [
.
©©[ \
Message
©©\ c
)
©©c d
;
©©d e
}
™™ 
return
¨¨ 
oList
¨¨ 
;
¨¨ 
}
≠≠ 	
}
ÆÆ 
}ØØ ˘Ç
cD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\MedisynAD\PacientesAD\TabPacientesAD.cs
	namespace 	
Dat
 
. 
Oracle 
. 
	MedisynAD 
. 
PacientesAD *
{ 
public 

class 
TabPacientesAD 
{ 
private 
TabPacienteE 
LlenarEntidad *
(* +
IDataReader+ 6
dr7 9
,9 :
int; >
pOrden? E
=F G
$numH I
)I J
{ 	
TabPacienteE 
oTabPacienteE &
=' (
new) ,
TabPacienteE- 9
(9 :
): ;
;; <
oTabPacienteE 
. 
IdAmbulatorio '
=( )
(* +
string+ 1
)1 2
dr2 4
[4 5
$str5 E
]E F
;F G
oTabPacienteE 
. !
UserW_IdGrupoFamiliar /
=0 1
(2 3
string3 9
)9 :
dr: <
[< =
$str= P
]P Q
;Q R
oTabPacienteE 
. 
UserW_CodParentesco -
=. /
dr0 2
[2 3
$str3 ?
]? @
+A B
$strC E
;E F
oTabPacienteE 
. 
UserW_CodParentesco -
=. /
(0 1
oTabPacienteE1 >
.> ?
UserW_CodParentesco? R
==S U
$strV X
?Y Z
$str[ ^
:_ `
oTabPacienteEa n
.n o 
UserW_CodParentesco	o Ç
)
Ç É
;
É Ñ
switch 
( 
oTabPacienteE !
.! "
UserW_CodParentesco" 5
)5 6
{ 
case 
$str 
: 
{ 
oTabPacienteE %
.% &
UserW_DscParentesco& 9
=: ;
$str< E
;E F
break 
; 
} 
case   
$str   
:   
{!! 
oTabPacienteE"" %
.""% &
UserW_DscParentesco""& 9
="": ;
$str""< E
;""E F
break## 
;## 
}$$ 
case&& 
$str&& 
:&& 
{'' 
oTabPacienteE(( %
.((% &
UserW_DscParentesco((& 9
=((: ;
$str((< B
;((B C
break)) 
;)) 
}** 
default,, 
:,, 
{-- 
oTabPacienteE.. %
...% &
UserW_DscParentesco..& 9
=..: ;
$str..< E
;..E F
break// 
;// 
}00 
}11 
return33 
oTabPacienteE33  
;33  !
}44 	
public66 
List66 
<66 
TabPacienteE66  
>66  !'
ObtenerGrupoFamiliarPackAge66" =
(66= >
string66> D

IdPaciente66E O
)66O P
{77 	
TabPacienteE88 
objAmReservaE88 &
=88' (
new88) ,
TabPacienteE88- 9
(889 :
)88: ;
;88; <
List99 
<99 
TabPacienteE99 
>99 
ListReservaE99 +
=99, -
new99. 1
List992 6
<996 7
TabPacienteE997 C
>99C D
(99D E
)99E F
;99F G
try;; 
{<< 
string== 
	wSqlQuery==  
===! "
$str==# N
;==N O
using?? 
(?? 
OracleConnection?? '
cnn??( +
=??, -
new??. 1
OracleConnection??2 B
(??B C
VariablesGlobales??C T
.??T U

CnnMedisyn??U _
)??_ `
)??` a
{@@ 
usingAA 
(AA 
OracleCommandAA (
cmdAA) ,
=AA- .
newAA/ 2
OracleCommandAA3 @
(AA@ A
	wSqlQueryAAA J
,AAJ K
cnnAAL O
)AAO P
)AAP Q
{BB 
cnnCC 
.CC 
OpenCC  
(CC  !
)CC! "
;CC" #
cmdDD 
.DD 
CommandTypeDD '
=DD( )
CommandTypeDD* 5
.DD5 6
StoredProcedureDD6 E
;DDE F
cmdEE 
.EE 

ParametersEE &
.EE& '
AddEE' *
(EE* +
$strEE+ ?
,EE? @
OracleDbTypeEEA M
.EEM N
Int64EEN S
)EES T
.EET U
ValueEEU Z
=EE[ \

IdPacienteEE] g
;EEg h
cmdFF 
.FF 

ParametersFF &
.FF& '
AddFF' *
(FF* +
$strFF+ ;
,FF; <
OracleDbTypeFF= I
.FFI J
	RefCursorFFJ S
,FFS T
ParameterDirectionFFU g
.FFg h
OutputFFh n
)FFn o
;FFo p
OracleDataReaderGG (
drGG) +
=GG, -
cmdGG. 1
.GG1 2
ExecuteReaderGG2 ?
(GG? @
)GG@ A
;GGA B
TabPacienteEII $
objPacienteII% 0
=II1 2
newII3 6
TabPacienteEII7 C
(IIC D
)IID E
;IIE F
whileJJ 
(JJ 
drJJ !
.JJ! "
ReadJJ" &
(JJ& '
)JJ' (
)JJ( )
ListReservaEKK (
.KK( )
AddKK) ,
(KK, -
LlenarEntidadKK- :
(KK: ;
drKK; =
,KK= >
$numKK? @
)KK@ A
)KKA B
;KKB C
cmdMM 
.MM 
DisposeMM #
(MM# $
)MM$ %
;MM% &
}NN 
cnnPP 
.PP 
DisposePP 
(PP  
)PP  !
;PP! "
cnnQQ 
.QQ 
CloseQQ 
(QQ 
)QQ 
;QQ  
}RR 
}SS 
catchTT 
(TT 
	ExceptionTT 
exTT 
)TT  
{UU 
throwVV 
newVV 
	ExceptionVV #
(VV# $
$strVV$ B
+VVC D
exVVE G
.VVG H
MessageVVH O
)VVO P
;VVP Q
}WW 
returnYY 
ListReservaEYY 
;YY  
}ZZ 	
public\\ 
DataSet\\ 
ObtenerDepatamentos\\ *
(\\* +
string\\+ 1

CodEmpresa\\2 <
)\\< =
{]] 	
TabPacienteE^^ 
objAmReservaE^^ &
=^^' (
new^^) ,
TabPacienteE^^- 9
(^^9 :
)^^: ;
;^^; <
List__ 
<__ 
TabPacienteE__ 
>__ 
ListReservaE__ +
=__, -
new__. 1
List__2 6
<__6 7
TabPacienteE__7 C
>__C D
(__D E
)__E F
;__F G
string`` 
	wSqlQuery`` 
=`` 
$str`` !
;``! "
DataSetaa 
dsaa 
=aa 
newaa 
DataSetaa $
(aa$ %
)aa% &
;aa& '
trycc 
{dd 
	wSqlQueryee 
=ee 
$stree 5
;ee5 6
OracleConnectiongg  
cnngg! $
=gg% &
newgg' *
OracleConnectiongg+ ;
(gg; <
VariablesGlobalesgg< M
.ggM N

CnnMedisynggN X
)ggX Y
;ggY Z
cnnhh 
.hh 
Openhh 
(hh 
)hh 
;hh 
OracleCommandii 
cmdii !
=ii" #
newii$ '
OracleCommandii( 5
(ii5 6
)ii6 7
;ii7 8
cmdll 
.ll 
CommandTextll 
=ll  !
	wSqlQueryll" +
;ll+ ,
cmdmm 
.mm 
CommandTypemm 
=mm  !
CommandTypemm" -
.mm- .
StoredProceduremm. =
;mm= >
cmdnn 
.nn 

Parametersnn 
.nn 
Addnn "
(nn" #
$strnn# 4
,nn4 5
OracleDbTypenn6 B
.nnB C
LongnnC G
,nnG H
$numnnI J
,nnJ K

CodEmpresannL V
,nnV W
ParameterDirectionnnX j
.nnj k
Inputnnk p
)nnp q
;nnq r
cmdoo 
.oo 

Parametersoo 
.oo 
Addoo "
(oo" #
$stroo# 3
,oo3 4
OracleDbTypeoo5 A
.ooA B
	RefCursorooB K
,ooK L
ParameterDirectionooM _
.oo_ `
Outputoo` f
)oof g
;oog h
cmdpp 
.pp 

Connectionpp 
=pp  
cnnpp! $
;pp$ %
OracleDataAdapterqq !
daqq" $
=qq% &
newqq' *
OracleDataAdapterqq+ <
(qq< =
cmdqq= @
)qq@ A
;qqA B
dass 
.ss 
Fillss 
(ss 
dsss 
)ss 
;ss 
cmduu 
.uu 
Disposeuu 
(uu 
)uu 
;uu 
cnnvv 
.vv 
Disposevv 
(vv 
)vv 
;vv 
cnnww 
.ww 
Closeww 
(ww 
)ww 
;ww 
}xx 
catchyy 
(yy 
	Exceptionyy 
exyy 
)yy  
{zz 
throw{{ 
new{{ 
	Exception{{ #
({{# $
$str{{$ B
+{{C D
ex{{E G
.{{G H
Message{{H O
){{O P
;{{P Q
}|| 
return}} 
ds}} 
;}} 
}~~ 	
public
ÅÅ 
List
ÅÅ 
<
ÅÅ 
TabPacienteE
ÅÅ  
>
ÅÅ  !#
ObtenerGrupoFamiliar2
ÅÅ" 7
(
ÅÅ7 8
string
ÅÅ8 >
IdAmbulatoria
ÅÅ? L
)
ÅÅL M
{
ÇÇ 	
IDataReader
ÉÉ 
dr
ÉÉ 
;
ÉÉ 
TabPacienteE
ÑÑ 
objAmReservaE
ÑÑ &
=
ÑÑ' (
new
ÑÑ) ,
TabPacienteE
ÑÑ- 9
(
ÑÑ9 :
)
ÑÑ: ;
;
ÑÑ; <
List
ÖÖ 
<
ÖÖ 
TabPacienteE
ÖÖ 
>
ÖÖ 
ListReservaE
ÖÖ +
=
ÖÖ, -
new
ÖÖ. 1
List
ÖÖ2 6
<
ÖÖ6 7
TabPacienteE
ÖÖ7 C
>
ÖÖC D
(
ÖÖD E
)
ÖÖE F
;
ÖÖF G
string
ÜÜ 
	wSqlQuery
ÜÜ 
=
ÜÜ 
$str
ÜÜ !
;
ÜÜ! "
try
ââ 
{
ää 
	wSqlQuery
ãã 
=
ãã 
$str
ãã 
+
ãã  
$str
ãã! *
+
ãã+ ,
$str
ãã- c
+
ããd e
$strããf â
+ããä ã
$strããå Ã
+ããÕ Œ
$strããœ Í
+ããÎ Ï
IdAmbulatoriaããÌ ˙
.ãã˙ ˚
Trimãã˚ ˇ
(ããˇ Ä
)ããÄ Å
+ããÇ É
$strããÑ ±
;ãã± ≤
using
çç 
(
çç 
OracleConnection
çç '
cnn
çç( +
=
çç, -
new
çç. 1
OracleConnection
çç2 B
(
ççB C
VariablesGlobales
ççC T
.
ççT U

CnnMedisyn
ççU _
)
çç_ `
)
çç` a
{
éé 
using
èè 
(
èè 
OracleCommand
èè (
cmd
èè) ,
=
èè- .
new
èè/ 2
OracleCommand
èè3 @
(
èè@ A
	wSqlQuery
èèA J
,
èèJ K
cnn
èèL O
)
èèO P
)
èèP Q
{
êê 
cmd
ëë 
.
ëë 
CommandType
ëë '
=
ëë( )
CommandType
ëë* 5
.
ëë5 6
Text
ëë6 :
;
ëë: ;
cnn
íí 
.
íí 
Open
íí  
(
íí  !
)
íí! "
;
íí" #
dr
ìì 
=
ìì 
cmd
ìì  
.
ìì  !
ExecuteReader
ìì! .
(
ìì. /
)
ìì/ 0
;
ìì0 1
while
îî 
(
îî 
dr
îî !
.
îî! "
Read
îî" &
(
îî& '
)
îî' (
)
îî( )
ListReservaE
ïï (
.
ïï( )
Add
ïï) ,
(
ïï, -
LlenarEntidad
ïï- :
(
ïï: ;
dr
ïï; =
)
ïï= >
)
ïï> ?
;
ïï? @
cmd
ññ 
.
ññ 
Dispose
ññ #
(
ññ# $
)
ññ$ %
;
ññ% &
cnn
óó 
.
óó 
Dispose
óó #
(
óó# $
)
óó$ %
;
óó% &
cnn
òò 
.
òò 
Close
òò !
(
òò! "
)
òò" #
;
òò# $
}
ôô 
}
öö 
}
õõ 
catch
úú 
(
úú 
	Exception
úú 
ex
úú 
)
úú  
{
ùù 
throw
ûû 
new
ûû 
	Exception
ûû #
(
ûû# $
$str
ûû$ =
+
ûû> ?
ex
ûû@ B
.
ûûB C
Message
ûûC J
)
ûûJ K
;
ûûK L
}
üü 
return
†† 
ListReservaE
†† 
;
††  
}
°° 	
public
®® 
List
®® 
<
®® 
TabPacienteE
®®  
>
®®  !0
"ObtenerGrupoFamiliarxIdAmbulatorio
®®" D
(
®®D E
string
®®E K
IdAmbulatoria
®®L Y
)
®®Y Z
{
©© 	
IDataReader
™™ 
dr
™™ 
;
™™ 
TabPacienteE
´´ 
objAmReservaE
´´ &
=
´´' (
new
´´) ,
TabPacienteE
´´- 9
(
´´9 :
)
´´: ;
;
´´; <
List
¨¨ 
<
¨¨ 
TabPacienteE
¨¨ 
>
¨¨ 
ListReservaE
¨¨ +
=
¨¨, -
new
¨¨. 1
List
¨¨2 6
<
¨¨6 7
TabPacienteE
¨¨7 C
>
¨¨C D
(
¨¨D E
)
¨¨E F
;
¨¨F G
string
≠≠ 
	wSqlQuery
≠≠ 
=
≠≠ 
$str
≠≠ !
;
≠≠! "
try
∞∞ 
{
±± 
	wSqlQuery
≤≤ 
=
≤≤ 
$str
≤≤ 
+
≤≤  
$str
≤≤! ~
+≤≤ Ä
$str
≥≥! D
+
≥≥E F
$str¥¥! ®
+¥¥© ™
IdAmbulatoria¥¥´ ∏
.¥¥∏ π
Trim¥¥π Ω
(¥¥Ω æ
)¥¥æ ø
+¥¥¿ ¡
$str¥¥¬ ⁄
;¥¥⁄ €
using
∂∂ 
(
∂∂ 
OracleConnection
∂∂ '
cnn
∂∂( +
=
∂∂, -
new
∂∂. 1
OracleConnection
∂∂2 B
(
∂∂B C
VariablesGlobales
∂∂C T
.
∂∂T U

CnnMedisyn
∂∂U _
)
∂∂_ `
)
∂∂` a
{
∑∑ 
using
∏∏ 
(
∏∏ 
OracleCommand
∏∏ (
cmd
∏∏) ,
=
∏∏- .
new
∏∏/ 2
OracleCommand
∏∏3 @
(
∏∏@ A
	wSqlQuery
∏∏A J
,
∏∏J K
cnn
∏∏L O
)
∏∏O P
)
∏∏P Q
{
ππ 
cmd
∫∫ 
.
∫∫ 
CommandType
∫∫ '
=
∫∫( )
CommandType
∫∫* 5
.
∫∫5 6
Text
∫∫6 :
;
∫∫: ;
cnn
ªª 
.
ªª 
Open
ªª  
(
ªª  !
)
ªª! "
;
ªª" #
dr
ºº 
=
ºº 
cmd
ºº  
.
ºº  !
ExecuteReader
ºº! .
(
ºº. /
)
ºº/ 0
;
ºº0 1
while
ΩΩ 
(
ΩΩ 
dr
ΩΩ !
.
ΩΩ! "
Read
ΩΩ" &
(
ΩΩ& '
)
ΩΩ' (
)
ΩΩ( )
ListReservaE
ææ (
.
ææ( )
Add
ææ) ,
(
ææ, -
LlenarEntidad
ææ- :
(
ææ: ;
dr
ææ; =
)
ææ= >
)
ææ> ?
;
ææ? @
cmd
øø 
.
øø 
Dispose
øø #
(
øø# $
)
øø$ %
;
øø% &
cnn
¿¿ 
.
¿¿ 
Dispose
¿¿ #
(
¿¿# $
)
¿¿$ %
;
¿¿% &
cnn
¡¡ 
.
¡¡ 
Close
¡¡ !
(
¡¡! "
)
¡¡" #
;
¡¡# $
}
¬¬ 
}
√√ 
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
	Exception
≈≈ 
ex
≈≈ 
)
≈≈  
{
∆∆ 
throw
«« 
new
«« 
	Exception
«« #
(
««# $
$str
««$ =
+
««> ?
ex
««@ B
.
««B C
Message
««C J
)
««J K
;
««K L
}
»» 
return
…… 
ListReservaE
…… 
;
……  
}
   	
}
ÀÀ 
}ÃÃ ©_
ZD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\MedisynAD\HisADTAD\HisADTAD.cs
	namespace

 	
Dat


 
.

 
Oracle

 
.

 
	MedisynAD

 
.

 
HisADTAD

 '
{ 
public 

class 
HisADTAD 
{ 
public 
string 
Insert_HIS_ADT $
($ %
int% (
COD_EMPRESA) 4
,4 5
string6 <
COD_SUCURSAL= I
,I J
stringK Q
EVENT_IDR Z
,Z [
string\ b
EVENT_DATETIMEc q
,q r
strings y
EVENT_TYPE_ID	z á
,
á à
string
â è
ID_PACIENTE
ê õ
,
õ ú
string
ù £
RUT_PACIENTE
§ ∞
,
∞ ±
string
≤ ∏
TIPO_PACIENTE
π ∆
,
∆ «
string
» Œ
DEATH_INDICATOR
œ ﬁ
,
ﬁ ﬂ
string
‡ Ê
CAT_NAME
Á Ô
,
Ô 
string
Ò ˜
	LAST_NAME
¯ Å
,
Å Ç
string
É â

FIRST_NAME
ä î
,
î ï
string
ñ ú

BIRTH_DATE
ù ß
,
ß ®
string
© Ø

GENDER_KEY
∞ ∫
,
∫ ª
string
º ¬
LAST_UPDATED
√ œ
,
œ –
string
— ◊
STREET_ADDRESS
ÿ Ê
,
Ê Á
string
Ë Ó
CITY
Ô Û
,
Û Ù
string
ı ˚
COUNTRY
¸ É
,
É Ñ
string
Ö ã
PHONE_NUMBER
å ò
,
ò ô
string
ö †
PRIMARY
° ®
,
® ©
string
™ ∞
PATIENT_CLASS_KEY
± ¬
)
¬ √
{ 	
try 
{ 
try 
{ 
string 
	wSqlQuery $
=% &
$str' )
;) *
	wSqlQuery 
= 
$str  "
+# $
$str% S
;S T
using 
( 
OracleConnection +
cnn, /
=0 1
new2 5
OracleConnection6 F
(F G
VariablesGlobalesG X
.X Y

CnnMedisynY c
)c d
)d e
{ 
using 
( 
OracleCommand ,
cmd- 0
=1 2
new3 6
OracleCommand7 D
(D E
	wSqlQueryE N
,N O
cnnP S
)S T
)T U
{ 
cmd 
.  
CommandType  +
=, -
CommandType. 9
.9 :
StoredProcedure: I
;I J
cmd 
.  

Parameters  *
.* +
Add+ .
(. /
new/ 2
OracleParameter3 B
(B C
$strC R
,R S
OracleDbTypeT `
.` a
Int32a f
)f g
)g h
.h i
Valuei n
=o p
COD_EMPRESAr }
;} ~
cmd 
.  

Parameters  *
.* +
Add+ .
(. /
new/ 2
OracleParameter3 B
(B C
$strC S
,S T
OracleDbTypeU a
.a b
Varchar2b j
)j k
)k l
.l m
Valuem r
=s t
COD_SUCURSAL	u Å
;
Å Ç
cmd 
.  

Parameters  *
.* +
Add+ .
(. /
new/ 2
OracleParameter3 B
(B C
$strC O
,O P
OracleDbTypeQ ]
.] ^
Varchar2^ f
)f g
)g h
.h i
Valuei n
=o p
EVENT_IDq y
;y z
cmd   
.    

Parameters    *
.  * +
Add  + .
(  . /
new  / 2
OracleParameter  3 B
(  B C
$str  C U
,  U V
OracleDbType  W c
.  c d
Date  d h
)  h i
)  i j
.  j k
Value  k p
=  q r
EVENT_DATETIME	  s Å
;
  Å Ç
cmd!! 
.!!  

Parameters!!  *
.!!* +
Add!!+ .
(!!. /
new!!/ 2
OracleParameter!!3 B
(!!B C
$str!!C T
,!!T U
OracleDbType!!V b
.!!b c
Varchar2!!c k
)!!k l
)!!l m
.!!m n
Value!!n s
=!!t u
EVENT_TYPE_ID	!!v É
;
!!É Ñ
cmd"" 
.""  

Parameters""  *
.""* +
Add""+ .
("". /
new""/ 2
OracleParameter""3 B
(""B C
$str""C R
,""R S
OracleDbType""T `
.""` a
Varchar2""a i
)""i j
)""j k
.""k l
Value""l q
=""r s
ID_PACIENTE""t 
;	"" Ä
cmd## 
.##  

Parameters##  *
.##* +
Add##+ .
(##. /
new##/ 2
OracleParameter##3 B
(##B C
$str##C S
,##S T
OracleDbType##U a
.##a b
	NVarchar2##b k
)##k l
)##l m
.##m n
Value##n s
=##t u
RUT_PACIENTE	##v Ç
;
##Ç É
cmd$$ 
.$$  

Parameters$$  *
.$$* +
Add$$+ .
($$. /
new$$/ 2
OracleParameter$$3 B
($$B C
$str$$C T
,$$T U
OracleDbType$$V b
.$$b c
Varchar2$$c k
)$$k l
)$$l m
.$$m n
Value$$n s
=$$t u
TIPO_PACIENTE	$$v É
;
$$É Ñ
cmd%% 
.%%  

Parameters%%  *
.%%* +
Add%%+ .
(%%. /
new%%/ 2
OracleParameter%%3 B
(%%B C
$str%%C V
,%%V W
OracleDbType%%X d
.%%d e
Varchar2%%e m
)%%m n
)%%n o
.%%o p
Value%%p u
=%%v w
DEATH_INDICATOR	%%x á
;
%%á à
cmd&& 
.&&  

Parameters&&  *
.&&* +
Add&&+ .
(&&. /
new&&/ 2
OracleParameter&&3 B
(&&B C
$str&&C O
,&&O P
OracleDbType&&Q ]
.&&] ^
Varchar2&&^ f
)&&f g
)&&g h
.&&h i
Value&&i n
=&&o p
CAT_NAME&&q y
;&&y z
cmd'' 
.''  

Parameters''  *
.''* +
Add''+ .
(''. /
new''/ 2
OracleParameter''3 B
(''B C
$str''C P
,''P Q
OracleDbType''R ^
.''^ _
Varchar2''_ g
)''g h
)''h i
.''i j
Value''j o
=''p q
	LAST_NAME''r {
;''{ |
cmd(( 
.((  

Parameters((  *
.((* +
Add((+ .
(((. /
new((/ 2
OracleParameter((3 B
(((B C
$str((C Q
,((Q R
OracleDbType((S _
.((_ `
Varchar2((` h
)((h i
)((i j
.((j k
Value((k p
=((q r

FIRST_NAME((s }
;((} ~
cmd)) 
.))  

Parameters))  *
.))* +
Add))+ .
()). /
new))/ 2
OracleParameter))3 B
())B C
$str))C Q
,))Q R
OracleDbType))S _
.))_ `
Varchar2))` h
)))h i
)))i j
.))j k
Value))k p
=))q r

BIRTH_DATE))s }
;))} ~
cmd** 
.**  

Parameters**  *
.*** +
Add**+ .
(**. /
new**/ 2
OracleParameter**3 B
(**B C
$str**C Q
,**Q R
OracleDbType**S _
.**_ `
Varchar2**` h
)**h i
)**i j
.**j k
Value**k p
=**q r

GENDER_KEY**s }
;**} ~
cmd++ 
.++  

Parameters++  *
.++* +
Add+++ .
(++. /
new++/ 2
OracleParameter++3 B
(++B C
$str++C S
,++S T
OracleDbType++U a
.++a b
Varchar2++b j
)++j k
)++k l
.++l m
Value++m r
=++s t
LAST_UPDATED	++u Å
;
++Å Ç
cmd,, 
.,,  

Parameters,,  *
.,,* +
Add,,+ .
(,,. /
new,,/ 2
OracleParameter,,3 B
(,,B C
$str,,C U
,,,U V
OracleDbType,,W c
.,,c d
Varchar2,,d l
),,l m
),,m n
.,,n o
Value,,o t
=,,u v
STREET_ADDRESS	,,w Ö
;
,,Ö Ü
cmd-- 
.--  

Parameters--  *
.--* +
Add--+ .
(--. /
new--/ 2
OracleParameter--3 B
(--B C
$str--C K
,--K L
OracleDbType--M Y
.--Y Z
Varchar2--Z b
)--b c
)--c d
.--d e
Value--e j
=--k l
CITY--m q
;--q r
cmd.. 
...  

Parameters..  *
...* +
Add..+ .
(... /
new../ 2
OracleParameter..3 B
(..B C
$str..C N
,..N O
OracleDbType..P \
...\ ]
Varchar2..] e
)..e f
)..f g
...g h
Value..h m
=..n o
COUNTRY..p w
;..w x
cmd// 
.//  

Parameters//  *
.//* +
Add//+ .
(//. /
new/// 2
OracleParameter//3 B
(//B C
$str//C S
,//S T
OracleDbType//U a
.//a b
Varchar2//b j
)//j k
)//k l
.//l m
Value//m r
=//s t
PHONE_NUMBER	//u Å
;
//Å Ç
cmd00 
.00  

Parameters00  *
.00* +
Add00+ .
(00. /
new00/ 2
OracleParameter003 B
(00B C
$str00C N
,00N O
OracleDbType00P \
.00\ ]
Varchar200] e
)00e f
)00f g
.00g h
Value00h m
=00n o
PRIMARY00p w
;00w x
cmd11 
.11  

Parameters11  *
.11* +
Add11+ .
(11. /
new11/ 2
OracleParameter113 B
(11B C
$str11C X
,11X Y
OracleDbType11Z f
.11f g
Varchar211g o
)11o p
)11p q
.11q r
Value11r w
=11x y
PATIENT_CLASS_KEY	11z ã
;
11ã å
cnn33 
.33  
Open33  $
(33$ %
)33% &
;33& '
OracleDataAdapter44 -
da44. 0
=441 2
new443 6
OracleDataAdapter447 H
(44H I
cmd44I L
)44L M
;44M N
try55 
{66 
DataSet77  '
ds77( *
=77+ ,
new77- 0
DataSet771 8
(778 9
)779 :
;77: ;
da88  "
.88" #
Fill88# '
(88' (
ds88( *
)88* +
;88+ ,
return99  &
$str99' 2
;992 3
}:: 
catch;; !
(;;" #
	Exception;;# ,
ex;;- /
);;/ 0
{<< 
return==  &
$str==' \
+==] ^
ex==_ a
.==a b
Message==b i
;==i j
}>> 
}?? 
}@@ 
}AA 
catchBB 
(BB 
	ExceptionBB  
exBB! #
)BB# $
{CC 
throwDD 
newDD 
	ExceptionDD '
(DD' (
$strDD( F
+DDG H
exDDI K
.DDK L
MessageDDL S
)DDS T
;DDT U
}EE 
}FF 
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG  
{HH 
returnII 
$strII /
+II0 1
exII2 4
.II4 5
MessageII5 <
;II< =
}JJ 
}KK 	
}LL 
}MM ï'
aD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\Dat.Oracle\MedisynAD\CorreosAD\GenEnvioMailAD.cs
	namespace 	
Dat
 
. 
Oracle 
. 
	MedisynAD 
. 
	CorreosAD (
{ 
public 

class 
GenEnvioMailAD 
{ 
private 
GenEnvioMailE 
LlenarEntidad +
(+ ,
IDataReader, 7
dr8 :
): ;
{ 	
GenEnvioMailE 
oGenEnvioMailE (
=) *
new+ .
GenEnvioMailE/ <
(< =
)= >
;> ?
oGenEnvioMailE 
. 
IdMail !
=" #
($ %
string% +
)+ ,
dr, .
[. /
$str/ 8
]8 9
;9 :
oGenEnvioMailE 
. 
MailTo !
=" #
($ %
string% +
)+ ,
dr, .
[. /
$str/ 8
]8 9
;9 :
oGenEnvioMailE 
. 
MailCC !
=" #
($ %
string% +
)+ ,
dr, .
[. /
$str/ 8
]8 9
;9 :
oGenEnvioMailE 
. 
MailBody #
=$ %
(& '
string' -
)- .
dr. 0
[0 1
$str1 <
]< =
;= >
oGenEnvioMailE 
. 

MailSubjet %
=& '
(( )
string) /
)/ 0
dr0 2
[2 3
$str3 @
]@ A
;A B
return 
oGenEnvioMailE !
;! "
} 	
public 
List 
< 
GenEnvioMailE !
>! "
ConsultarEnvioMail# 5
(5 6
ref6 9
int: =
IdMailUltimo> J
)J K
{ 	
IDataReader 
dr 
; 
List 
< 
GenEnvioMailE 
> 
ListGenEnvioMailE  1
=2 3
new4 7
List8 <
<< =
GenEnvioMailE= J
>J K
(K L
)L M
;M N
string   
	wSqlQuery   
=   
$str   !
;  ! "
try"" 
{## 
	wSqlQuery$$ 
=$$ 
$str$$ 
+$$  
$str$$! a
+$$b c
$str	$$d ”
+
$$‘ ’
$str
$$÷ Ó
+
$$Ô 
$str
$$Ò ù
+
$$û ü
IdMailUltimo
$$† ¨
.
$$¨ ≠
ToString
$$≠ µ
(
$$µ ∂
)
$$∂ ∑
+
$$∏ π
$str
$$∫ Ω
+
$$æ ø
$str
$$¿ Ï
;
$$Ï Ì
using&& 
(&& 
OracleConnection&& '
cnn&&( +
=&&, -
new&&. 1
OracleConnection&&2 B
(&&B C
VariablesGlobales&&C T
.&&T U

CnnMedisyn&&U _
)&&_ `
)&&` a
{'' 
using(( 
((( 
OracleCommand(( (
cmd(() ,
=((- .
new((/ 2
OracleCommand((3 @
(((@ A
	wSqlQuery((A J
,((J K
cnn((L O
)((O P
)((P Q
{)) 
cmd** 
.** 
CommandType** '
=**( )
CommandType*** 5
.**5 6
Text**6 :
;**: ;
cnn++ 
.++ 
Open++  
(++  !
)++! "
;++" #
dr,, 
=,, 
cmd,,  
.,,  !
ExecuteReader,,! .
(,,. /
),,/ 0
;,,0 1
while-- 
(-- 
dr-- !
.--! "
Read--" &
(--& '
)--' (
)--( )
ListGenEnvioMailE.. -
...- .
Add... 1
(..1 2
LlenarEntidad..2 ?
(..? @
dr..@ B
)..B C
)..C D
;..D E
dr// 
.// 
Dispose// "
(//" #
)//# $
;//$ %
dr00 
.00 
Close00  
(00  !
)00! "
;00" #
cmd11 
.11 
Dispose11 #
(11# $
)11$ %
;11% &
cnn22 
.22 
Dispose22 #
(22# $
)22$ %
;22% &
cnn33 
.33 
Close33 !
(33! "
)33" #
;33# $
}44 
}55 
}66 
catch77 
(77 
	Exception77 
ex77 
)77  
{88 
throw99 
new99 
	Exception99 #
(99# $
$str99$ K
+99L M
ex99N P
.99P Q
Message99Q X
)99X Y
;99Y Z
}:: 
return;; 
ListGenEnvioMailE;; $
;;;$ %
}<< 	
}== 
}>> 