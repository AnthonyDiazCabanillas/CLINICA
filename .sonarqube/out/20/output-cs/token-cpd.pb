¨
GD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\App.Clinica\Program.cs
	namespace 	
App
 
. 
Clinica 
{ 
internal		 
static		 
class		 
Program		 !
{

 
public 
static 
IConfiguration $
Configuration% 2
;2 3
[ 	
	STAThread	 
] 
static 
void 
Main 
( 
) 
{ 	
var 
builder 
= 
new  
ConfigurationBuilder 2
(2 3
)3 4
.4 5
AddJsonFile5 @
(@ A
$strA S
,S T
optionalU ]
:] ^
true_ c
,c d
reloadOnChangee s
:s t
trueu y
)y z
;z {
Configuration 
= 
builder #
.# $
Build$ )
() *
)* +
;+ ,
Application 
. 
SetHighDpiMode &
(& '
HighDpiMode' 2
.2 3
SystemAware3 >
)> ?
;? @
Application 
. 
EnableVisualStyles *
(* +
)+ ,
;, -
Application 
. -
!SetCompatibleTextRenderingDefault 9
(9 :
false: ?
)? @
;@ A
var 
cnxCSF 
= 
Program  
.  !
Configuration! .
.. /

GetSection/ 9
(9 :
$str: M
)M N
.N O
GetO R
<R S
CnxCSFS Y
>Y Z
(Z [
)[ \
;\ ]
Bus 
. 
AgendaClinica 
. 
Clinica %
.% &
VariablesGlobales& 7
.7 8
LoadConectionString8 K
(K L
cnxCSFL R
.R S

CnnClinicaS ]
,] ^
Bus_ b
.b c
AgendaClinicac p
.p q
Clinicaq x
.x y
VariablesGlobales	y ä
.
ä ã
ListDataBase
ã ó
.
ó ò
clinica
ò ü
)
ü †
;
† °
Bus   
.   
AgendaClinica   
.   
Clinica   %
.  % &
VariablesGlobales  & 7
.  7 8
LoadConectionString  8 K
(  K L
cnxCSF  L R
.  R S
CnnLogistica  S _
,  _ `
Bus  a d
.  d e
AgendaClinica  e r
.  r s
Clinica  s z
.  z {
VariablesGlobales	  { å
.
  å ç
ListDataBase
  ç ô
.
  ô ö
	logistica
  ö £
)
  £ §
;
  § •
Application$$ 
.$$ 
Run$$ 
($$ 
new$$ 
frmMain$$  '
($$' (
)$$( )
)$$) *
;$$* +
}%% 	
}&& 
})) ó
GD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\App.Clinica\frmMain.cs
	namespace 	
App
 
. 
Clinica 
{ 
public 

partial 
class 
frmMain  
:! "
Form# '
{ 
public 
frmMain 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private

 
void

  
btnPagoReserva_Click

 )
(

) *
object

* 0
sender

1 7
,

7 8
	EventArgs

9 B
e

C D
)

D E
{ 	
Cita 
. 
frmDatosReserva  
ofrmDatosReserva! 1
=2 3
new4 7
Cita8 <
.< =
frmDatosReserva= L
(L M
)M N
;N O
ofrmDatosReserva 
. 
Show !
(! "
)" #
;# $
} 	
private 
void 
btnSiteds_Click $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
Cita 
. 
	frmSiteds 

ofrmSiteds %
=& '
new( +
Cita, 0
.0 1
	frmSiteds1 :
(: ;
); <
;< =

ofrmSiteds 
. 
Show 
( 
) 
; 
} 	
private 
void 
frmMain_Load !
(! "
object" (
sender) /
,/ 0
	EventArgs1 :
e; <
)< =
{ 	
} 	
} 
} ˚Á
ND:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\App.Clinica\Cita\frmSiteds.cs
	namespace 	
App
 
. 
Clinica 
. 
Cita 
{ 
public 

partial 
class 
	frmSiteds "
:# $
Form% )
{ 
string 
xSunasa 
= 
$str 
; 
string 
xIAFAS 
= 
$str 
; 
string 
xRuc 
= 
$str 
; 
SitedsWs 
	oWsSiteds 
= 
new  
SitedsWs! )
() *
)* +
;+ ,
	Generales   

oGenerales   
=   
new   "
	Generales  # ,
(  , -
)  - .
;  . /
AsegNombRequest"" 
oAsegNombRequest"" (
="") *
new""+ .
AsegNombRequest""/ >
(""> ?
)""? @
;""@ A
AsegNombResponse## 
	oAsegNomb## "
=### $
new##% (
AsegNombResponse##) 9
(##9 :
)##: ;
;##; <
AsegCodRequest%% 
oAsegCodRequest%% &
=%%' (
new%%) ,
AsegCodRequest%%- ;
(%%; <
)%%< =
;%%= >
AsegCodResponse&& 
oAsegCodResponse&& (
=&&) *
new&&+ .
AsegCodResponse&&/ >
(&&> ?
)&&? @
;&&@ A%
NumeroAutorizacionRequest(( !#
oNumAutorizacionRequest((" 9
=((: ;
new((< ?%
NumeroAutorizacionRequest((@ Y
(((Y Z
)((Z [
;(([ \&
NumeroAutorizacionResponse)) " 
oNumAutorizacionResp))# 7
=))8 9
new)): =&
NumeroAutorizacionResponse))> X
())X Y
)))Y Z
;))Z [
Coberturas_AsegCode++ 
oCoberturas++ '
=++( )
new++* -
Coberturas_AsegCode++. A
(++A B
)++B C
;++C D
ObservacionRequest,, 
oObservacionRequest,, .
=,,/ 0
new,,1 4
ObservacionRequest,,5 G
(,,G H
),,H I
;,,I J
FotoRequest// 
oFotoRequest//  
=//! "
new//# &
FotoRequest//' 2
(//2 3
)//3 4
;//4 5#
CasoTiempoEsperaRequest00 $
oCasoTiempoEsperaRequest00  8
=009 :
new00; >#
CasoTiempoEsperaRequest00? V
(00V W
)00W X
;00X Y(
CasoExcepcionCarenciaRequest11 $)
oCasoExcepcionCarenciaRequest11% B
=11C D
new11E H(
CasoExcepcionCarenciaRequest11I e
(11e f
)11f g
;11g h"
CondicionMedicaRequest22 #
oCondicionMedicaRequest22 6
=227 8
new229 <"
CondicionMedicaRequest22= S
(22S T
)22T U
;22U V#
DatosAdicionalesRequest33 $
oDatosAdicionalesRequest33  8
=339 :
new33; >#
DatosAdicionalesRequest33? V
(33V W
)33W X
;33X Y
CorreoAgenda66 
objCorreoAgenda66 $
=66% &
new66' *
CorreoAgenda66+ 7
(667 8
)668 9
;669 :"
AdmisionHospitalariaWs77 !
oAdmisionHospitalaria77 4
=775 6
new777 :"
AdmisionHospitalariaWs77; Q
(77Q R
)77R S
;77S T+
ProcedimientosEspecialesRequest99 ',
 oProcedimientosEspecialesRequest99( H
=99I J
new99K N+
ProcedimientosEspecialesRequest99O n
(99n o
)99o p
;99p q
string:: 

stringJson:: 
;:: 
string;; 
[;; 
];; 
listaCobertura;; 
=;;  !
new;;" %
string;;& ,
[;;, -
$num;;- .
];;. /
;;;/ 0
string<< 
[<< 
]<< 
	listaIafa<< 
=<< 
new<<  
string<<! '
[<<' (
$num<<( )
]<<) *
;<<* +

Utilitario?? 
util?? 
=?? 
new?? 

Utilitario?? (
(??( )
)??) *
;??* +
MdsynDatosPagosEAA 
oMdsynDatosPagosEAA *
=AA+ ,
newAA- 0
MdsynDatosPagosEAA1 A
(AAA B
)AAB C
;AAC D
stringBB 
RutaWS_SitedsBB 
=BB 
$strBB G
;BBG H
boolEE 
PuedoPintarEE 
=EE 
falseEE  
;EE  !
PenFF 
pFF 
=FF 
newFF 
PenFF 
(FF 
BrushesFF 
.FF  
BlackFF  %
,FF% &
(FF' (
floatFF( -
)FF- .
$numFF. 2
)FF2 3
;FF3 4
GraphicsGG 
gGG 
;GG 
SystemHH 
.HH 
DrawingHH 
.HH 
	Drawing2DHH  
.HH  !
GraphicsPathHH! -
phHH. 0
=HH1 2
newHH3 6
SystemHH7 =
.HH= >
DrawingHH> E
.HHE F
	Drawing2DHHF O
.HHO P
GraphicsPathHHP \
(HH\ ]
SystemHH] c
.HHc d
DrawingHHd k
.HHk l
	Drawing2DHHl u
.HHu v
FillModeHHv ~
.HH~ 
	Alternate	HH à
)
HHà â
;
HHâ ä
boolII 
SwichII 
=II 
falseII 
;II 
objectJJ 
x1JJ 
,JJ 
y1JJ 
,JJ 
x2JJ 
,JJ 
y2JJ 
;JJ 
publicOO 
	frmSitedsOO 
(OO 
)OO 
{PP 	
InitializeComponentQQ 
(QQ  
)QQ  !
;QQ! "
}RR 	
privateTT 
voidTT 
frmSiteds_LoadTT #
(TT# $
objectTT$ *
senderTT+ 1
,TT1 2
	EventArgsTT3 <
eTT= >
)TT> ?
{UU 	
DatWW 
.WW 
SqlWW 
.WW 
VariablesGlobalesWW %
.WW% &
Clinica_AsignaSedeWW& 8
(WW8 9
)WW9 :
;WW: ;
xRucXX 
=XX 
TxtRUCXX 
.XX 
TextXX 
;XX 
xSunasaYY 
=YY 
	TxtSUNASAYY 
.YY  
TextYY  $
;YY$ %
listaCobertura[[ 
=[[ 
new[[  
string[[! '
[[[' (
][[( )
{[[* +
$str[[, 2
,[[2 3
$str[[4 :
,[[: ;
$str[[< B
,[[B C
$str[[D J
}[[K L
;[[L M
	listaIafa\\ 
=\\ 
new\\ 
string\\ "
[\\" #
]\\# $
{\\% &
$str\\' .
,\\. /
$str\\0 7
,\\7 8
$str\\9 @
,\\@ A
$str\\B I
,\\I J
$str\\K R
,\\R S
$str\\T [
,\\[ \
$str\\] d
,\\d e
$str\\f m
}\\n o
;\\o p
Busee 
.ee 
AgendaClinicaee 
.ee 
Clinicaee %
.ee% &
VariablesGlobalesee& 7
.ee7 8
LoadInitialDataee8 G
(eeG H
)eeH I
;eeI J
varoo 
bmpoo 
=oo 
newoo 
Bitmapoo  
(oo  !
thisoo! %
.oo% &
pctFirmaoo& .
.oo. /
Sizeoo/ 3
.oo3 4
Widthoo4 9
,oo9 :
thisoo; ?
.oo? @
pctFirmaoo@ H
.ooH I
SizeooI M
.ooM N
HeightooN T
)ooT U
;ooU V
pctFirmapp 
.pp 
Imagepp 
=pp 
bmppp  
;pp  !
gqq 
=qq 
Graphicsqq 
.qq 
	FromImageqq "
(qq" #
thisqq# '
.qq' (
pctFirmaqq( 0
.qq0 1
Imageqq1 6
)qq6 7
;qq7 8
grr 
.rr 
Clearrr 
(rr 
Colorrr 
.rr 
Whiterr 
)rr  
;rr  !
xSunasatt 
=tt 
	TxtSUNASAtt 
.tt  
Texttt  $
;tt$ %
xIAFASuu 
=uu 
TxtIAFASuu 
.uu 
Textuu "
;uu" #
xRucvv 
=vv 
TxtRUCvv 
.vv 
Textvv 
;vv 

oGeneralesyy 
.yy (
CargarIniObtenerPagosVisaNetyy 3
(yy3 4
)yy4 5
;yy5 6

oGeneraleszz 
.zz 
CargarIniQRzz "
(zz" #
)zz# $
;zz$ %!
oAdmisionHospitalaria|| !
.||! "
CargarIniCorreo||" 1
(||1 2
)||2 3
;||3 4
WindowState 
= 
FormWindowState )
.) *
	Minimized* 3
;3 4
this
ÅÅ 
.
ÅÅ 
Text
ÅÅ 
=
ÅÅ 
$str
ÅÅ 6
+
ÅÅ7 8
$str
ÅÅ9 <
+
ÅÅ= >
Bus
ÅÅ? B
.
ÅÅB C
	Utilities
ÅÅC L
.
ÅÅL M
ConnectionsString
ÅÅM ^
.
ÅÅ^ _
Server
ÅÅ_ e
+
ÅÅf g
$str
ÅÅh q
;
ÅÅq r
}
ÑÑ 	
private
àà 
void
àà &
btnConsultaAsegNom_Click
àà -
(
àà- .
object
àà. 4
sender
àà5 ;
,
àà; <
	EventArgs
àà= F
e
ààG H
)
ààH I
{
ââ 	
xIAFAS
èè 
=
èè 
TxtIAFAS
èè 
.
èè 
Text
èè "
;
èè" #

TxtRUC_Cod
êê 
.
êê 
Text
êê 
=
êê 
xRuc
êê "
;
êê" #
TxtSUNASA_Cod
ëë 
.
ëë 
Text
ëë 
=
ëë  
xSunasa
ëë! (
;
ëë( )
TxtIAFAS_Cod
íí 
.
íí 
Text
íí 
=
íí 
xIAFAS
íí  &
;
íí& '
	oWsSiteds
ïï 
=
ïï 
new
ïï 
SitedsWs
ïï $
(
ïï$ %
)
ïï% &
;
ïï& '
	oWsSiteds
ññ 
.
ññ 

AsignaIAFA
ññ  
(
ññ  !
xRuc
ññ! %
,
ññ% &
xSunasa
ññ' .
,
ññ. /
xIAFAS
ññ0 6
)
ññ6 7
;
ññ7 8
oAsegNombRequest
òò 
=
òò 
new
òò "
AsegNombRequest
òò# 2
(
òò2 3
xRuc
òò3 7
,
òò7 8
xSunasa
òò9 @
,
òò@ A
xIAFAS
òòB H
)
òòH I
;
òòI J
oAsegNombRequest
öö 
.
öö &
CodTipoDocumentoAfiliado
öö 5
=
öö6 7)
TxtCodTipoDocumentoAfiliado
öö8 S
.
ööS T
Text
ööT X
;
ööX Y
oAsegNombRequest
õõ 
.
õõ %
NumeroDocumentoAfiliado
õõ 4
=
õõ5 6(
txtNumeroDocumentoAfiliado
õõ7 Q
.
õõQ R
Text
õõR V
;
õõV W
oAsegNombRequest
úú 
.
úú 
NombresAfiliado
úú ,
=
úú- . 
TxtNombresAfiliado
úú/ A
.
úúA B
Text
úúB F
;
úúF G
oAsegNombRequest
ùù 
.
ùù %
ApellidoPaternoAfiliado
ùù 4
=
ùù5 6(
txtApellidoPaternoAfiliado
ùù7 Q
.
ùùQ R
Text
ùùR V
;
ùùV W
oAsegNombRequest
ûû 
.
ûû %
ApellidoMaternoAfiliado
ûû 4
=
ûû5 6(
txtApellidoMaternoAfiliado
ûû7 Q
.
ûûQ R
Text
ûûR V
;
ûûV W
oAsegNombRequest
üü 
.
üü 
CodEspecialidad
üü ,
=
üü- . 
TxtCodEspecialidad
üü/ A
.
üüA B
Text
üüB F
;
üüF G

stringJson
°° 
=
°° 
ConsultaAsegNom
°° (
(
°°( )
RutaWS_Siteds
°°) 6
,
°°6 7
oAsegNombRequest
°°8 H
)
°°H I
;
°°I J
List
•• 
<
•• 
AsegNombResponse
•• !
>
••! "#
oListAsegNombResponse
••# 8
=
••9 :
(
••; <
List
••< @
<
••@ A
AsegNombResponse
••A Q
>
••Q R
)
••R S

Newtonsoft
••S ]
.
••] ^
Json
••^ b
.
••b c
JsonConvert
••c n
.
••n o 
DeserializeObject••o Ä
(••Ä Å

stringJson••Å ã
,••ã å
typeof••ç ì
(••ì î
List••î ò
<••ò ô 
AsegNombResponse••ô ©
>••© ™
)••™ ´
)••´ ¨
;••¨ ≠
	gvAsegNom
¶¶ 
.
¶¶ 

DataSource
¶¶  
=
¶¶! "#
oListAsegNombResponse
¶¶# 8
;
¶¶8 9
if
®® 
(
®® #
oListAsegNombResponse
®® %
==
®®& (
null
®®) -
)
®®- .
return
®®/ 5
;
®®5 6
oAsegCodRequest
©© 
=
©© 
	oWsSiteds
©© '
.
©©' ()
mtdAsignarAseguradoCorrecto
©©( C
(
©©C D#
oListAsegNombResponse
©©D Y
,
©©Y Z
oAsegNombRequest
©©[ k
.
©©k l&
NumeroDocumentoAfiliado©©l É
,©©É Ñ
true©©Ö â
)©©â ä
;©©ä ã
oAsegCodRequest
´´ 
.
´´ 
RUC
´´ 
=
´´  !
oAsegNombRequest
´´" 2
.
´´2 3
RUC
´´3 6
;
´´6 7
oAsegCodRequest
¨¨ 
.
¨¨ 
IAFAS
¨¨ !
=
¨¨" #
oAsegNombRequest
¨¨$ 4
.
¨¨4 5
IAFAS
¨¨5 :
;
¨¨: ;
oAsegCodRequest
≠≠ 
.
≠≠ 
SUNASA
≠≠ "
=
≠≠# $
oAsegNombRequest
≠≠% 5
.
≠≠5 6
SUNASA
≠≠6 <
;
≠≠< =$
TxtNombresAfiliado_Cod
∞∞ "
.
∞∞" #
Text
∞∞# '
=
∞∞( )
oAsegCodRequest
∞∞* 9
.
∞∞9 :
NombresAfiliado
∞∞: I
;
∞∞I J,
TxtApellidoPaternoAfiliado_Cod
±± *
.
±±* +
Text
±±+ /
=
±±0 1
oAsegCodRequest
±±2 A
.
±±A B%
ApellidoPaternoAfiliado
±±B Y
;
±±Y Z,
TxtApellidoMaternoAfiliado_Cod
≤≤ *
.
≤≤* +
Text
≤≤+ /
=
≤≤0 1
oAsegCodRequest
≤≤2 A
.
≤≤A B%
ApellidoMaternoAfiliado
≤≤B Y
;
≤≤Y Z#
TxtCodigoAfiliado_Cod
≥≥ !
.
≥≥! "
Text
≥≥" &
=
≥≥' (
oAsegCodRequest
≥≥) 8
.
≥≥8 9
CodigoAfiliado
≥≥9 G
;
≥≥G H,
TxtNumeroDocumentoAfiliado_Cod
¥¥ *
.
¥¥* +
Text
¥¥+ /
=
¥¥0 1
oAsegCodRequest
¥¥2 A
.
¥¥A B%
NumeroDocumentoAfiliado
¥¥B Y
;
¥¥Y Z 
TxtCodProducto_Cod
µµ 
.
µµ 
Text
µµ #
=
µµ$ %
oAsegCodRequest
µµ& 5
.
µµ5 6
CodProducto
µµ6 A
;
µµA B 
TxtDesProducto_Cod
∂∂ 
.
∂∂ 
Text
∂∂ #
=
∂∂$ %
oAsegCodRequest
∂∂& 5
.
∂∂5 6
DesProducto
∂∂6 A
;
∂∂A B
TxtNumeroPlan_Cod
∑∑ 
.
∑∑ 
Text
∑∑ "
=
∑∑# $
oAsegCodRequest
∑∑% 4
.
∑∑4 5

NumeroPlan
∑∑5 ?
;
∑∑? @-
TxtCodTipoDocumentoAfiliado_Cod
∏∏ +
.
∏∏+ ,
Text
∏∏, 0
=
∏∏1 2
oAsegCodRequest
∏∏3 B
.
∏∏B C&
CodTipoDocumentoAfiliado
∏∏C [
;
∏∏[ \ 
TxtDesProducto_Cod
ππ 
.
ππ 
Text
ππ #
=
ππ$ %
oAsegCodRequest
ππ& 5
.
ππ5 6
DesProducto
ππ6 A
;
ππA B
TxtNumeroPlan_Cod
∫∫ 
.
∫∫ 
Text
∫∫ "
=
∫∫# $
oAsegCodRequest
∫∫% 4
.
∫∫4 5

NumeroPlan
∫∫5 ?
;
∫∫? @0
"TxtCodTipoDocumentoContratante_Cod
ªª .
.
ªª. /
Text
ªª/ 3
=
ªª4 5
oAsegCodRequest
ªª6 E
.
ªªE F)
CodTipoDocumentoContratante
ªªF a
;
ªªa b/
!TxtNumeroDocumentoContratante_Cod
ºº -
.
ºº- .
Text
ºº. 2
=
ºº3 4
oAsegCodRequest
ºº5 D
.
ººD E(
NumeroDocumentoContratante
ººE _
;
ºº_ `&
TxtNombreContratante_Cod
ΩΩ $
.
ΩΩ$ %
Text
ΩΩ% )
=
ΩΩ* +
oAsegCodRequest
ΩΩ, ;
.
ΩΩ; <
NombreContratante
ΩΩ< M
;
ΩΩM N"
TxtCodParentesco_Cod
ææ  
.
ææ  !
Text
ææ! %
=
ææ& '
oAsegCodRequest
ææ( 7
.
ææ7 8
CodParentesco
ææ8 E
;
ææE F/
!TxtTipoCalificadorContratante_Cod
øø -
.
øø- .
Text
øø. 2
=
øø3 4
oAsegCodRequest
øø5 D
.
øøD E(
TipoCalificadorContratante
øøE _
;
øø_ `$
TxtCodEspecialidad_Cod
¿¿ "
.
¿¿" #
Text
¿¿# '
=
¿¿( )
oAsegCodRequest
¿¿* 9
.
¿¿9 :
CodEspecialidad
¿¿: I
;
¿¿I J
}
¬¬ 	
private
ƒƒ 
void
ƒƒ 
btnAsegCod_Click
ƒƒ %
(
ƒƒ% &
object
ƒƒ& ,
sender
ƒƒ- 3
,
ƒƒ3 4
	EventArgs
ƒƒ5 >
e
ƒƒ? @
)
ƒƒ@ A
{
≈≈ 	

stringJson
«« 
=
«« 
ConsultaAsegCod
«« (
(
««( )
RutaWS_Siteds
««) 6
,
««6 7
oAsegCodRequest
««8 G
)
««G H
;
««H I
oAsegCodResponse
»» 
=
»» 
(
»»  
AsegCodResponse
»»  /
)
»»/ 0

Newtonsoft
»»0 :
.
»»: ;
Json
»»; ?
.
»»? @
JsonConvert
»»@ K
.
»»K L
DeserializeObject
»»L ]
(
»»] ^

stringJson
»»^ h
,
»»h i
typeof
»»j p
(
»»p q
AsegCodResponse»»q Ä
)»»Ä Å
)»»Å Ç
;»»Ç É
if
   
(
   
oAsegCodResponse
    
==
  ! #
null
  $ (
)
  ( )
return
  * 0
;
  0 1
if
ÀÀ 
(
ÀÀ 
oAsegCodResponse
ÀÀ  
.
ÀÀ  !

Coberturas
ÀÀ! +
==
ÀÀ, .
null
ÀÀ/ 3
)
ÀÀ3 4
return
ÀÀ5 ;
;
ÀÀ; <
List
ÕÕ 
<
ÕÕ $
DatosAfiliado_AsegCode
ÕÕ '
>
ÕÕ' ('
lstDatosAfiliado_AsegCode
ÕÕ) B
=
ÕÕC D
new
ÕÕE H
List
ÕÕI M
<
ÕÕM N$
DatosAfiliado_AsegCode
ÕÕN d
>
ÕÕd e
(
ÕÕe f
)
ÕÕf g
;
ÕÕg h'
lstDatosAfiliado_AsegCode
ŒŒ %
.
ŒŒ% &
Add
ŒŒ& )
(
ŒŒ) *
oAsegCodResponse
ŒŒ* :
.
ŒŒ: ;
DatosAfiliado
ŒŒ; H
)
ŒŒH I
;
ŒŒI J

gvAsegCod0
–– 
.
–– 

DataSource
–– !
=
––" #'
lstDatosAfiliado_AsegCode
––$ =
;
––= >
	gvAsegCod
—— 
.
—— 

DataSource
——  
=
——! "
oAsegCodResponse
——# 3
.
——3 4

Coberturas
——4 >
;
——> ?
string
““ 
TipoAfiliacion
““ !
=
““" #
oAsegCodResponse
““$ 4
.
““4 5
DatosAfiliado
““5 B
.
““B C
CodTipoAfiliacion
““C T
.
““T U
	Substring
““U ^
(
““^ _
$num
““_ `
,
““` a
$num
““b c
)
““c d
;
““d e
oCoberturas
÷÷ 
=
÷÷ 
oAsegCodResponse
÷÷ *
.
÷÷* +

Coberturas
÷÷+ 5
.
◊◊ 
Where
◊◊ "
(
◊◊" #
x
◊◊# $
=>
◊◊% '
listaCobertura
◊◊( 6
.
◊◊6 7
Contains
◊◊7 ?
(
◊◊? @
x
◊◊@ A
.
◊◊A B
CodigoCobertura
◊◊B Q
)
◊◊Q R
)
◊◊R S
.
ÿÿ 
FirstOrDefault
ÿÿ +
(
ÿÿ+ ,
)
ÿÿ, -
;
ÿÿ- .
}
⁄⁄ 	
private
›› 
void
›› #
btnAutorizacion_Click
›› *
(
››* +
object
››+ 1
sender
››2 8
,
››8 9
	EventArgs
››: C
e
››D E
)
››E F
{
ﬁﬁ 	
if
ﬂﬂ 
(
ﬂﬂ 
oCoberturas
ﬂﬂ 
==
ﬂﬂ 
null
ﬂﬂ #
)
ﬂﬂ# $
return
ﬂﬂ% +
;
ﬂﬂ+ ,
if
‡‡ 
(
‡‡ 
oCoberturas
‡‡ 
.
‡‡ 
CodigoCobertura
‡‡ +
==
‡‡, .
null
‡‡/ 3
)
‡‡3 4
return
‡‡5 ;
;
‡‡; <%
oNumAutorizacionRequest
‚‚ #
=
‚‚$ %
	oWsSiteds
‚‚& /
.
‚‚/ 0"
fnNumeroAutorizacion
‚‚0 D
(
‚‚D E
oCoberturas
‚‚E P
,
‚‚P Q
oAsegCodResponse
‚‚R b
)
‚‚b c
;
‚‚c d

stringJson
„„ 
=
„„ (
ConsultaNumeroAutorizacion
„„ 3
(
„„3 4
RutaWS_Siteds
„„4 A
,
„„A B%
oNumAutorizacionRequest
„„C Z
)
„„Z [
;
„„[ \"
oNumAutorizacionResp
ÂÂ  
=
ÂÂ! "
(
ÂÂ# $(
NumeroAutorizacionResponse
ÂÂ$ >
)
ÂÂ> ?

Newtonsoft
ÂÂ? I
.
ÂÂI J
Json
ÂÂJ N
.
ÂÂN O
JsonConvert
ÂÂO Z
.
ÂÂZ [
DeserializeObject
ÂÂ[ l
(
ÂÂl m

stringJson
ÂÂm w
,
ÂÂw x
typeof
ÂÂy 
(ÂÂ Ä*
NumeroAutorizacionResponseÂÂÄ ö
)ÂÂö õ
)ÂÂõ ú
;ÂÂú ù
List
ÁÁ 
<
ÁÁ (
NumeroAutorizacionResponse
ÁÁ +
>
ÁÁ+ ,+
lstNumeroAutorizacionResponse
ÁÁ- J
=
ÁÁK L
new
ÁÁM P
List
ÁÁQ U
<
ÁÁU V(
NumeroAutorizacionResponse
ÁÁV p
>
ÁÁp q
(
ÁÁq r
)
ÁÁr s
;
ÁÁs t+
lstNumeroAutorizacionResponse
ËË )
.
ËË) *
Add
ËË* -
(
ËË- ."
oNumAutorizacionResp
ËË. B
)
ËËB C
;
ËËC D
gvAutorizacion
ÈÈ 
.
ÈÈ 

DataSource
ÈÈ %
=
ÈÈ& '+
lstNumeroAutorizacionResponse
ÈÈ( E
;
ÈÈE F!
oObservacionRequest
ÏÏ 
=
ÏÏ  !
	oWsSiteds
ÏÏ" +
.
ÏÏ+ ,"
fnObservacionRequest
ÏÏ, @
(
ÏÏ@ A%
oNumAutorizacionRequest
ÏÏA X
,
ÏÏX Y
oAsegCodRequest
ÏÏZ i
)
ÏÏi j
;
ÏÏj k

stringJson
ÌÌ 
=
ÌÌ !
ConsultaObservacion
ÌÌ ,
(
ÌÌ, -
RutaWS_Siteds
ÌÌ- :
,
ÌÌ: ;!
oObservacionRequest
ÌÌ< O
)
ÌÌO P
;
ÌÌP Q!
ObservacionResponse
ÓÓ "
oObservacionResponse
ÓÓ  4
=
ÓÓ5 6
(
ÓÓ7 8!
ObservacionResponse
ÓÓ8 K
)
ÓÓK L

Newtonsoft
ÓÓL V
.
ÓÓV W
Json
ÓÓW [
.
ÓÓ[ \
JsonConvert
ÓÓ\ g
.
ÓÓg h
DeserializeObject
ÓÓh y
(
ÓÓy z

stringJsonÓÓz Ñ
,ÓÓÑ Ö
typeofÓÓÜ å
(ÓÓå ç#
ObservacionResponseÓÓç †
)ÓÓ† °
)ÓÓ° ¢
;ÓÓ¢ £
List
 
<
 !
ObservacionResponse
 $
>
$ %$
lstObservacionResponse
& <
=
= >
new
? B
List
C G
<
G H!
ObservacionResponse
H [
>
[ \
(
\ ]
)
] ^
;
^ _$
lstObservacionResponse
ÒÒ "
.
ÒÒ" #
Add
ÒÒ# &
(
ÒÒ& '"
oObservacionResponse
ÒÒ' ;
)
ÒÒ; <
;
ÒÒ< =
gvObservacion
ÚÚ 
.
ÚÚ 

DataSource
ÚÚ $
=
ÚÚ% &$
lstObservacionResponse
ÚÚ' =
;
ÚÚ= >&
oCasoTiempoEsperaRequest
ıı $
=
ıı% &
	oWsSiteds
ıı' 0
.
ıı0 1'
fnCasoTiempoEsperaRequest
ıı1 J
(
ııJ K%
oNumAutorizacionRequest
ııK b
,
ııb c
oCoberturas
ııd o
)
ııo p
;
ııp q

stringJson
ˆˆ 
=
ˆˆ 
CasoTiempoEspera
ˆˆ )
(
ˆˆ) *
RutaWS_Siteds
ˆˆ* 7
,
ˆˆ7 8&
oCasoTiempoEsperaRequest
ˆˆ9 Q
)
ˆˆQ R
;
ˆˆR S&
CasoTiempoEsperaResponse
˜˜ $'
oCasoTiempoEsperaResponse
˜˜% >
=
˜˜? @
(
˜˜A B&
CasoTiempoEsperaResponse
˜˜B Z
)
˜˜Z [

Newtonsoft
˜˜[ e
.
˜˜e f
Json
˜˜f j
.
˜˜j k
JsonConvert
˜˜k v
.
˜˜v w 
DeserializeObject˜˜w à
(˜˜à â

stringJson˜˜â ì
,˜˜ì î
typeof˜˜ï õ
(˜˜õ ú(
CasoTiempoEsperaResponse˜˜ú ¥
)˜˜¥ µ
)˜˜µ ∂
;˜˜∂ ∑
List
˘˘ 
<
˘˘ &
CasoTiempoEsperaResponse
˘˘ )
>
˘˘) *)
lstCasoTiempoEsperaResponse
˘˘+ F
=
˘˘G H
new
˘˘I L
List
˘˘M Q
<
˘˘Q R&
CasoTiempoEsperaResponse
˘˘R j
>
˘˘j k
(
˘˘k l
)
˘˘l m
;
˘˘m n)
lstCasoTiempoEsperaResponse
˙˙ '
.
˙˙' (
Add
˙˙( +
(
˙˙+ ,'
oCasoTiempoEsperaResponse
˙˙, E
)
˙˙E F
;
˙˙F G 
gvCasoTiempoEspera
˚˚ 
.
˚˚ 

DataSource
˚˚ )
=
˚˚* +)
lstCasoTiempoEsperaResponse
˚˚, G
;
˚˚G H.
 oProcedimientosEspecialesRequest
˛˛ ,
=
˛˛- .
	oWsSiteds
˛˛/ 8
.
˛˛8 97
)fnConsultaProcedimientosEspecialesRequest
˛˛9 b
(
˛˛b c%
oNumAutorizacionRequest
˛˛c z
,
˛˛z {
oCoberturas˛˛| á
)˛˛á à
;˛˛à â

stringJson
ˇˇ 
=
ˇˇ &
ProcedimientosEspeciales
ˇˇ 1
(
ˇˇ1 2
RutaWS_Siteds
ˇˇ2 ?
,
ˇˇ? @.
 oProcedimientosEspecialesRequest
ˇˇA a
)
ˇˇa b
;
ˇˇb c.
 ProcedimientosEspecialesResponse
ÄÄ ,/
!oProcedimientosEspecialesResponse
ÄÄ- N
=
ÄÄO P
(
ÄÄQ R.
 ProcedimientosEspecialesResponse
ÄÄR r
)
ÄÄr s

Newtonsoft
ÄÄs }
.
ÄÄ} ~
JsonÄÄ~ Ç
.ÄÄÇ É
JsonConvertÄÄÉ é
.ÄÄé è!
DeserializeObjectÄÄè †
(ÄÄ† °

stringJsonÄÄ° ´
,ÄÄ´ ¨
typeofÄÄ≠ ≥
(ÄÄ≥ ¥0
 ProcedimientosEspecialesResponseÄÄ¥ ‘
)ÄÄ‘ ’
)ÄÄ’ ÷
;ÄÄ÷ ◊
List
ÇÇ 
<
ÇÇ 
Procedimiento
ÇÇ 
>
ÇÇ 
lstProcedimiento
ÇÇ  0
=
ÇÇ1 2
new
ÇÇ3 6
List
ÇÇ7 ;
<
ÇÇ; <
Procedimiento
ÇÇ< I
>
ÇÇI J
(
ÇÇJ K
)
ÇÇK L
;
ÇÇL M
lstProcedimiento
ÉÉ 
.
ÉÉ 
Add
ÉÉ  
(
ÉÉ  !/
!oProcedimientosEspecialesResponse
ÉÉ! B
.
ÉÉB C
Procedimiento
ÉÉC P
)
ÉÉP Q
;
ÉÉQ R
gvProcedimiento
ÑÑ 
.
ÑÑ 

DataSource
ÑÑ &
=
ÑÑ' (
lstProcedimiento
ÑÑ) 9
;
ÑÑ9 :$
gvProcedimientoDetalle
ÜÜ "
.
ÜÜ" #

DataSource
ÜÜ# -
=
ÜÜ. //
!oProcedimientosEspecialesResponse
ÜÜ0 Q
.
ÜÜQ R
Procedimiento
ÜÜR _
.
ÜÜ_ `
Detalle
ÜÜ` g
;
ÜÜg h/
!gvProcedimientosEspecialesDetalle
áá -
.
áá- .

DataSource
áá. 8
=
áá9 :/
!oProcedimientosEspecialesResponse
áá; \
.
áá\ ]
Detalle
áá] d
;
áád e
}
ää 	
public
åå 
void
åå %
mtdCargarDatosCobertura
åå +
(
åå+ ,
AsegCodResponse
åå, ;
pAsegCodResponse
åå< L
,
ååL M!
Coberturas_AsegCode
ååN a
pCoberturas
ååb m
)
ååm n
{
çç 	
string
éé #
CodTipoConsultaMedica
éé (
=
éé) *
$str
éé+ -
,
éé- .
LineasCoberturas
èè  
=
èè! "
$str
èè# %
,
èè% &!
CodSubTipoCobertura
êê #
=
êê$ %
$str
êê& (
,
êê( )
	CodPoliza
ëë 
=
ëë 
$str
ëë 
,
ëë 
NumeroPlanPoliza
íí  
=
íí! "
$str
íí# %
,
íí% &
CodAseguradora
ìì 
=
ìì  
$str
ìì! #
,
ìì# $

CoPagoFijo
îî 
=
îî 
$str
îî 
,
îî  
CoPagoVariable
ïï 
=
ïï  
$str
ïï! #
;
ïï# $
if
óó 
(
óó #
CodTipoConsultaMedica
óó %
==
óó& (
$str
óó) ,
)
óó, -
{
òò 
LineasCoberturas
ôô  
=
ôô! "
LineasCoberturas
ôô# 3
+
ôô4 5
$str
ôô6 V
+
ôôW X
pAsegCodResponse
ôôY i
.
ôôi j
DatosAfiliado
ôôj w
.
ôôw x
DesTipoPlanôôx É
+ôôÑ Ö
$charôôÜ ä
+
öö 
$str
öö +
+
öö, -
pCoberturas
öö. 9
.
öö9 :

Beneficios
öö: D
+
ööE F
$char
ööG K
+
õõ 
$str
õõ $
+
õõ% &
pCoberturas
õõ' 2
.
õõ2 3
DesCopagoFijo
õõ3 @
+
õõA B
$char
õõC G
+
úú 
$str
úú (
+
úú) *
pCoberturas
úú+ 6
.
úú6 7
DesCopagoVariable
úú7 H
;
úúH I!
CodSubTipoCobertura
ûû #
=
ûû$ %
pCoberturas
ûû& 1
.
ûû1 2$
CodigoSubTipoCobertura
ûû2 H
;
ûûH I
if
†† 
(
†† 
NumeroPlanPoliza
†† $
.
††$ %
Length
††% +
>=
††, .
$num
††/ 0
)
††0 1
{
°° 
NumeroPlanPoliza
¢¢ $
=
¢¢% &
NumeroPlanPoliza
¢¢' 7
.
¢¢7 8
	Substring
¢¢8 A
(
¢¢A B
NumeroPlanPoliza
¢¢B R
.
¢¢R S
Length
¢¢S Y
-
¢¢Z [
$num
¢¢\ ]
,
¢¢] ^
$num
¢¢_ `
)
¢¢` a
;
¢¢a b
}
££ 
	CodPoliza
•• 
=
•• 
CodAseguradora
•• *
+
••+ ,
oAsegCodRequest
••- <
.
••< =

NumeroPlan
••= G
;
••G H
}
¶¶ 
else
ßß 
{
®® 
LineasCoberturas
©©  
=
©©! "
LineasCoberturas
©©# 3
+
©©4 5
$str
©©6 V
+
™™ 
$str
™™ "
+
™™# $
$char
™™% )
+
´´ 
$str
´´ +
+
´´, -
$str
´´. :
+
´´; <
$char
´´= A
+
¨¨ 
$str
¨¨ $
+
¨¨% &

CoPagoFijo
¨¨' 1
+
¨¨2 3
$char
¨¨4 8
+
≠≠ 
$str
≠≠ (
+
≠≠) *
CoPagoVariable
≠≠+ 9
;
≠≠9 :
	CodPoliza
ØØ 
=
ØØ 
CodAseguradora
ØØ *
+
ØØ+ ,
NumeroPlanPoliza
ØØ- =
;
ØØ= >
}
∞∞ 
}
±± 	
private
¥¥ 
void
¥¥ (
gvAsegNom_CellContentClick
¥¥ /
(
¥¥/ 0
object
¥¥0 6
sender
¥¥7 =
,
¥¥= >'
DataGridViewCellEventArgs
¥¥? X
e
¥¥Y Z
)
¥¥Z [
{
µµ 	
}
∑∑ 	
private
ππ 
void
ππ #
TxtSUNASA_TextChanged
ππ *
(
ππ* +
object
ππ+ 1
sender
ππ2 8
,
ππ8 9
	EventArgs
ππ: C
e
ππD E
)
ππE F
{
∫∫ 	
}
ºº 	
private
ææ 
void
ææ (
gvAsegCod_CellContentClick
ææ /
(
ææ/ 0
object
ææ0 6
sender
ææ7 =
,
ææ= >'
DataGridViewCellEventArgs
ææ? X
e
ææY Z
)
ææZ [
{
øø 	
}
¡¡ 	
private
√√ 
void
√√ 
panel3_Paint
√√ !
(
√√! "
object
√√" (
sender
√√) /
,
√√/ 0
PaintEventArgs
√√1 ?
e
√√@ A
)
√√A B
{
ƒƒ 	
}
∆∆ 	
private
»» 
void
»» +
splitContainer2_SplitterMoved
»» 2
(
»»2 3
object
»»3 9
sender
»»: @
,
»»@ A
SplitterEventArgs
»»B S
e
»»T U
)
»»U V
{
…… 	
}
ÀÀ 	
private
ÕÕ 
void
ÕÕ #
btnProcesarPago_Click
ÕÕ *
(
ÕÕ* +
object
ÕÕ+ 1
sender
ÕÕ2 8
,
ÕÕ8 9
	EventArgs
ÕÕ: C
e
ÕÕD E
)
ÕÕE F
{
ŒŒ 	

oGenerales
œœ 
.
œœ 
mtProcesarPagos
œœ &
(
œœ& '
)
œœ' (
;
œœ( )
}
–– 	
private
““ 
void
““ %
btnCrearDatodPago_Click
““ ,
(
““, -
object
““- 3
sender
““4 :
,
““: ;
	EventArgs
““< E
e
““F G
)
““G H
{
”” 	
int
‘‘ 
ide_cita
‘‘ 
=
‘‘ 
util
‘‘ 
.
‘‘  
ValInt
‘‘  &
(
‘‘& '
txtide_cita
‘‘' 2
.
‘‘2 3
Text
‘‘3 7
)
‘‘7 8
;
‘‘8 9
if
’’ 
(
’’ 
ide_cita
’’ 
==
’’ 
$num
’’ 
)
’’ 
{
÷÷ 

MessageBox
◊◊ 
.
◊◊ 
Show
◊◊ 
(
◊◊  
$str
◊◊  5
)
◊◊5 6
;
◊◊6 7
return
ÿÿ 
;
ÿÿ 
}
ŸŸ 

oGenerales
⁄⁄ 
.
⁄⁄ %
ProcesoPagoPorIdCitaPre
⁄⁄ .
(
⁄⁄. /
ide_cita
⁄⁄/ 7
)
⁄⁄7 8
;
⁄⁄8 9
}
€€ 	
private
ﬁﬁ 
void
ﬁﬁ 
btnAux01_Click
ﬁﬁ #
(
ﬁﬁ# $
object
ﬁﬁ$ *
sender
ﬁﬁ+ 1
,
ﬁﬁ1 2
	EventArgs
ﬁﬁ3 <
e
ﬁﬁ= >
)
ﬁﬁ> ?
{
ﬂﬂ 	(
txtNumeroDocumentoAfiliado
‡‡ &
.
‡‡& '
Text
‡‡' +
=
‡‡, -
txtDNICargaDato
‡‡. =
.
‡‡= >
Text
‡‡> B
;
‡‡B C
TxtIAFAS
·· 
.
·· 
Text
·· 
=
·· 
txtIAFASCargaDato
·· -
.
··- .
Text
··. 2
;
··2 3
}
‚‚ 	
private
‰‰ 
void
‰‰ %
btnProcesarPago_Click_1
‰‰ ,
(
‰‰, -
object
‰‰- 3
sender
‰‰4 :
,
‰‰: ;
	EventArgs
‰‰< E
e
‰‰F G
)
‰‰G H
{
ÂÂ 	
ProcesoServicio
ÊÊ 
(
ÊÊ 
)
ÊÊ 
;
ÊÊ 
}
ÁÁ 	
public
ÍÍ 
void
ÍÍ 
ProcesoServicio
ÍÍ #
(
ÍÍ# $
)
ÍÍ$ %
{
ÎÎ 	
try
ÏÏ 
{
ÌÌ #
oAdmisionHospitalaria
ÔÔ %
.
ÔÔ% &0
"MtEnviarCorreosDocumentosPacientes
ÔÔ& H
(
ÔÔH I
)
ÔÔI J
;
ÔÔJ K

oGenerales
ıı 
.
ıı 
mtProcesarPagos
ıı *
(
ıı* +
)
ıı+ ,
;
ıı, -

oGenerales
ˆˆ 
.
ˆˆ 
mtConfirmarCitas
ˆˆ +
(
ˆˆ+ ,
)
ˆˆ, -
;
ˆˆ- .

oGenerales
˜˜ 
.
˜˜ !
ObtenerPagosVisaNet
˜˜ .
(
˜˜. /
)
˜˜/ 0
;
˜˜0 1

oGenerales
˙˙ 
.
˙˙ &
MtEnvioQrEstacionamiento
˙˙ 3
(
˙˙3 4
)
˙˙4 5
;
˙˙5 6
}
¸¸ 
catch
˝˝ 
(
˝˝ 
	Exception
˝˝ 
ex
˝˝ 
)
˝˝  
{
˛˛ 
objCorreoAgenda
ˇˇ 
.
ˇˇ  #
GuardarMensajeNotepad
ˇˇ  5
(
ˇˇ5 6
ex
ˇˇ6 8
.
ˇˇ8 9
ToString
ˇˇ9 A
(
ˇˇA B
)
ˇˇB C
,
ˇˇC D
$str
ˇˇE V
)
ˇˇV W
;
ˇˇW X
}
ÄÄ 
}
ÅÅ 	
private
ÖÖ 
void
ÖÖ  
btnPagarCita_Click
ÖÖ '
(
ÖÖ' (
object
ÖÖ( .
sender
ÖÖ/ 5
,
ÖÖ5 6
	EventArgs
ÖÖ7 @
e
ÖÖA B
)
ÖÖB C
{
ÜÜ 	
int
áá 
ide_cita
áá 
=
áá 
util
áá 
.
áá  
ValInt
áá  &
(
áá& '
txtide_cita
áá' 2
.
áá2 3
Text
áá3 7
)
áá7 8
;
áá8 9
if
àà 
(
àà 
ide_cita
àà 
==
àà 
$num
àà 
)
àà 
{
ââ 

MessageBox
ää 
.
ää 
Show
ää 
(
ää  
$str
ää  5
)
ää5 6
;
ää6 7
return
ãã 
;
ãã 
}
åå 

oGenerales
çç 
.
çç &
ProcesoPagoPorIdCitaPost
çç /
(
çç/ 0
ide_cita
çç0 8
)
çç8 9
;
çç9 :
}
°° 	
private
££ 
void
££  
TxtRUC_TextChanged
££ '
(
££' (
object
££( .
sender
££/ 5
,
££5 6
	EventArgs
££7 @
e
££A B
)
££B C
{
§§ 	
}
¶¶ 	
private
®® 
void
®® #
btnObtenerIafas_Click
®® *
(
®®* +
object
®®+ 1
sender
®®2 8
,
®®8 9
	EventArgs
®®: C
e
®®D E
)
®®E F
{
©© 	
string
¨¨ 
dni
¨¨ 
=
¨¨ 
txtDNICargaDato
¨¨ (
.
¨¨( )
Text
¨¨) -
;
¨¨- . 
RetornaIAFASporDni
≠≠ 
(
≠≠ 
$str
≠≠ "
,
≠≠" #
dni
≠≠$ '
)
≠≠' (
;
≠≠( )
}
ÆÆ 	
private
±± 
void
±±  
RetornaIAFASporDni
±± '
(
±±' (
string
±±( .
tipo_documento
±±/ =
,
±±= >
string
±±? E
nro_documento
±±F S
)
±±S T
{
≤≤ 	
SitedsWs
≥≥ 
	oWsSiteds
≥≥ 
=
≥≥  
new
≥≥! $
SitedsWs
≥≥% -
(
≥≥- .
)
≥≥. /
;
≥≥/ 0
List
¥¥ 
<
¥¥ 
AsegCodRequest
¥¥ 
>
¥¥  
lstAsegCodRequest
¥¥! 2
=
¥¥3 4
	oWsSiteds
¥¥5 >
.
¥¥> ? 
RetornaIAFASporDni
¥¥? Q
(
¥¥Q R
Dat
¥¥R U
.
¥¥U V
Sql
¥¥V Y
.
¥¥Y Z
VariablesGlobales
¥¥Z k
.
¥¥k l
ClinicaE
¥¥l t
,
¥¥t u
tipo_documento¥¥v Ñ
,¥¥Ñ Ö
nro_documento¥¥Ü ì
)¥¥ì î
;¥¥î ï
gvDetalleAtencion
µµ 
.
µµ 

DataSource
µµ (
=
µµ) *
lstAsegCodRequest
µµ+ <
;
µµ< =
}
øø 	
private
¡¡ 
void
¡¡ .
 txttip_doc_identidad_TextChanged
¡¡ 5
(
¡¡5 6
object
¡¡6 <
sender
¡¡= C
,
¡¡C D
	EventArgs
¡¡E N
e
¡¡O P
)
¡¡P Q
{
¬¬ 	
}
ƒƒ 	
private
∆∆ 
void
∆∆ *
txtdoc_identidad_TextChanged
∆∆ 1
(
∆∆1 2
object
∆∆2 8
sender
∆∆9 ?
,
∆∆? @
	EventArgs
∆∆A J
e
∆∆K L
)
∆∆L M
{
«« 	
}
…… 	
private
ÕÕ 
void
ÕÕ )
btnObtenerIafasOptimo_Click
ÕÕ 0
(
ÕÕ0 1
object
ÕÕ1 7
sender
ÕÕ8 >
,
ÕÕ> ?
	EventArgs
ÕÕ@ I
e
ÕÕJ K
)
ÕÕK L
{
ŒŒ 	
string
œœ 
dni
œœ 
=
œœ 
txtDNICargaDato
œœ (
.
œœ( )
Text
œœ) -
;
œœ- .&
RetornaIAFASporDniOptimo
–– $
(
––$ %
$str
––% (
,
––( )
dni
––* -
)
––- .
;
––. /
}
““ 	
private
‘‘ 
void
‘‘ &
RetornaIAFASporDniOptimo
‘‘ -
(
‘‘- .
string
‘‘. 4
tipo_documento
‘‘5 C
,
‘‘C D
string
‘‘E K
nro_documento
‘‘L Y
)
‘‘Y Z
{
’’ 	
SitedsWs
÷÷ 
	oWsSiteds
÷÷ 
=
÷÷  
new
÷÷! $
SitedsWs
÷÷% -
(
÷÷- .
)
÷÷. /
;
÷÷/ 0
List
◊◊ 
<
◊◊ 
AsegCodRequest
◊◊ 
>
◊◊  
lstAsegCodRequest
◊◊! 2
=
◊◊3 4
	oWsSiteds
◊◊5 >
.
◊◊> ?(
RetornaIAFASporDniParalelo
◊◊? Y
(
◊◊Y Z
Dat
◊◊Z ]
.
◊◊] ^
Sql
◊◊^ a
.
◊◊a b
VariablesGlobales
◊◊b s
.
◊◊s t
ClinicaE
◊◊t |
,
◊◊| }
tipo_documento◊◊~ å
,◊◊å ç
nro_documento◊◊é õ
)◊◊õ ú
;◊◊ú ù
gvDetalleAtencion
ÿÿ 
.
ÿÿ 

DataSource
ÿÿ (
=
ÿÿ) *
lstAsegCodRequest
ÿÿ+ <
;
ÿÿ< =
}
‚‚ 	
private
‰‰ 
void
‰‰ )
gvDetalleAtencion_CellClick
‰‰ 0
(
‰‰0 1
object
‰‰1 7
sender
‰‰8 >
,
‰‰> ?'
DataGridViewCellEventArgs
‰‰@ Y
e
‰‰Z [
)
‰‰[ \
{
ÂÂ 	
int
ÊÊ 
index
ÊÊ 
=
ÊÊ 
e
ÊÊ 
.
ÊÊ 
RowIndex
ÊÊ "
;
ÊÊ" #
DataGridViewRow
ÁÁ 
selectedRow
ÁÁ '
=
ÁÁ( )
gvDetalleAtencion
ÁÁ* ;
.
ÁÁ; <
Rows
ÁÁ< @
[
ÁÁ@ A
index
ÁÁA F
]
ÁÁF G
;
ÁÁG H
gvDetalleAtencion
ËË 
.
ËË 
Rows
ËË "
[
ËË" #
selectedRow
ËË# .
.
ËË. /
Index
ËË/ 4
]
ËË4 5
.
ËË5 6
Selected
ËË6 >
=
ËË? @
true
ËËA E
;
ËËE F
}
ÈÈ 	
private
ÎÎ 
void
ÎÎ 
panel7_Paint
ÎÎ !
(
ÎÎ! "
object
ÎÎ" (
sender
ÎÎ) /
,
ÎÎ/ 0
PaintEventArgs
ÎÎ1 ?
e
ÎÎ@ A
)
ÎÎA B
{
ÏÏ 	
}
ÓÓ 	
private
 
void
 %
txtide_cita_TextChanged
 ,
(
, -
object
- 3
sender
4 :
,
: ;
	EventArgs
< E
e
F G
)
G H
{
ÒÒ 	
}
ÛÛ 	
private
ıı 
void
ıı !
btnVerDetalle_Click
ıı (
(
ıı( )
object
ıı) /
sender
ıı0 6
,
ıı6 7
	EventArgs
ıı8 A
e
ııB C
)
ııC D
{
ˆˆ 	
foreach
˜˜ 
(
˜˜ 
DataGridViewRow
˜˜ $
row
˜˜% (
in
˜˜) +
this
˜˜, 0
.
˜˜0 1
gvDetalleAtencion
˜˜1 B
.
˜˜B C
SelectedRows
˜˜C O
)
˜˜O P
{
¯¯ 
AsegCodRequest
˘˘ 
cust
˘˘ #
=
˘˘$ %
row
˘˘& )
.
˘˘) *
DataBoundItem
˘˘* 7
as
˘˘8 :
AsegCodRequest
˘˘; I
;
˘˘I J
if
˙˙ 
(
˙˙ 
cust
˙˙ 
!=
˙˙ 
null
˙˙  
)
˙˙  !
{
˚˚ !
pVerConsultaAsegCod
¸¸ '
(
¸¸' (
cust
¸¸( ,
)
¸¸, -
;
¸¸- .
return
˝˝ 
;
˝˝ 
}
˛˛ 
}
ˇˇ 
}
ÄÄ 	
private
ÇÇ 
void
ÇÇ !
pVerConsultaAsegCod
ÇÇ (
(
ÇÇ( )
AsegCodRequest
ÇÇ) 7
oAsegCodRequest
ÇÇ8 G
)
ÇÇG H
{
ÉÉ 	

stringJson
ÖÖ 
=
ÖÖ 
ConsultaAsegCod
ÖÖ (
(
ÖÖ( )
RutaWS_Siteds
ÖÖ) 6
,
ÖÖ6 7
oAsegCodRequest
ÖÖ8 G
)
ÖÖG H
;
ÖÖH I
oAsegCodResponse
ÜÜ 
=
ÜÜ 
(
ÜÜ  
AsegCodResponse
ÜÜ  /
)
ÜÜ/ 0

Newtonsoft
ÜÜ0 :
.
ÜÜ: ;
Json
ÜÜ; ?
.
ÜÜ? @
JsonConvert
ÜÜ@ K
.
ÜÜK L
DeserializeObject
ÜÜL ]
(
ÜÜ] ^

stringJson
ÜÜ^ h
,
ÜÜh i
typeof
ÜÜj p
(
ÜÜp q
AsegCodResponseÜÜq Ä
)ÜÜÄ Å
)ÜÜÅ Ç
;ÜÜÇ É
if
àà 
(
àà 
oAsegCodResponse
àà  
==
àà! #
null
àà$ (
)
àà( )
return
àà* 0
;
àà0 1
if
ââ 
(
ââ 
oAsegCodResponse
ââ  
.
ââ  !

Coberturas
ââ! +
==
ââ, .
null
ââ/ 3
)
ââ3 4
return
ââ5 ;
;
ââ; <
List
ãã 
<
ãã $
DatosAfiliado_AsegCode
ãã '
>
ãã' ('
lstDatosAfiliado_AsegCode
ãã) B
=
ããC D
new
ããE H
List
ããI M
<
ããM N$
DatosAfiliado_AsegCode
ããN d
>
ããd e
(
ããe f
)
ããf g
;
ããg h'
lstDatosAfiliado_AsegCode
åå %
.
åå% &
Add
åå& )
(
åå) *
oAsegCodResponse
åå* :
.
åå: ;
DatosAfiliado
åå; H
)
ååH I
;
ååI J(
dgwAsegCodResponseAfiliado
éé &
.
éé& '

DataSource
éé' 1
=
éé2 3'
lstDatosAfiliado_AsegCode
éé4 M
;
ééM N)
dgwAsegCodResponseCobertura
èè '
.
èè' (

DataSource
èè( 2
=
èè3 4
oAsegCodResponse
èè5 E
.
èèE F

Coberturas
èèF P
;
èèP Q
}
ññ 	
private
òò 
void
òò 
tabPage4_Click
òò #
(
òò# $
object
òò$ *
sender
òò+ 1
,
òò1 2
	EventArgs
òò3 <
e
òò= >
)
òò> ?
{
ôô 	
}
õõ 	
}
úú 
}ùù ±F
TD:\CLINICA\nsp-csfl-agenda-uti-automatizacion_qa\App.Clinica\Cita\frmDatosReserva.cs
	namespace 	
App
 
. 
Clinica 
. 
Cita 
{ 
public 

partial 
class 
frmDatosReserva (
:) *
Form+ /
{ 
UtilWinForm 
utilWF 
= 
new  
UtilWinForm! ,
(, -
)- .
;. /
	Generales 

oGenerales 
; 
bool 
form_started 
= 
false !
;! "
public 
frmDatosReserva 
( 
)  
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void  
frmDatosReserva_Load )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	!
Load_Initial_Synapsis   !
(  ! "
)  " #
;  # $
this"" 
."" 
Text"" 
="" 
this"" 
."" 
Text"" !
+""" #
$str""$ )
+""* +
Bus"", /
.""/ 0
	Utilities""0 9
.""9 :
ConnectionsString"": K
.""K L
Server""L R
+""S T
$str""U \
;""\ ]

oGenerales&& 
=&& 
new&& 
	Generales&& &
(&&& '
)&&' (
;&&( )
dtpFecInicio(( 
.(( 
MinDate((  
=((! "
DateTime((# +
.((+ ,
Now((, /
;((/ 0
dtpFecInicio)) 
.)) 
Value)) 
=))  
DateTime))! )
.))) *
Now))* -
;))- .
	dtpFecFin++ 
.++ 
MinDate++ 
=++ 
Convert++  '
.++' (

ToDateTime++( 2
(++2 3
DateTime++3 ;
.++; <
Now++< ?
.++? @
ToString++@ H
(++H I
$str++I U
)++U V
)++V W
;++W X
	dtpFecFin,, 
.,, 
Value,, 
=,, 
Convert,, %
.,,% &

ToDateTime,,& 0
(,,0 1
DateTime,,1 9
.,,9 :
Now,,: =
.,,= >
ToString,,> F
(,,F G
$str,,G S
),,S T
),,T U
.,,U V
	AddMonths,,V _
(,,_ `
$num,,` a
),,a b
.,,b c
AddDays,,c j
(,,j k
-,,k l
$num,,l m
),,m n
;,,n o
utilWF.. 
... 
MtdCargarCombo.. !
(..! "
cboSede.." )
,..) *
$str..+ 3
,..3 4
$str..5 =
,..= >
$str..? M
,..M N
$str..O Q
,..Q R
true..S W
)..W X
;..X Y
pConfiguraGrilla00 
(00 
)00 
;00 $
CargarGrillaDatosReserva11 $
(11$ %
)11% &
;11& '
form_started22 
=22 
true22 
;22  
}33 	
public55 
void55 $
CargarGrillaDatosReserva55 ,
(55, -
)55- .
{66 	
string77 
CodSede77 
=77 
$str77 
;77  
if88 
(88 
cboSede88 
.88 
Items88 
.88 
Count88 #
!=88$ &
$num88' (
)88( )
CodSede99 
=99 
cboSede99 !
.99! "
SelectedValue99" /
==990 2
null993 7
?998 9
$str99: <
:99= >
cboSede99? F
.99F G
SelectedValue99G T
.99T U
ToString99U ]
(99] ^
)99^ _
;99_ `
List;; 
<;; 
MdsynAmReservaE;;  
>;;  !
oList;;" '
=;;( )
new;;* -
List;;. 2
<;;2 3
MdsynAmReservaE;;3 B
>;;B C
(;;C D
);;D E
;;;E F
oList== 
=== 

oGenerales== 
.== "
Sp_Mdsyn_Cita_Consulta== 5
(==5 6
new==6 9
MdsynAmReservaE==: I
(==I J
$num==J K
,==K L
$num==M N
,==N O
dtpFecInicio==P \
.==\ ]
Value==] b
.==b c
ToString==c k
(==k l
$str==l x
)==x y
,==y z
	dtpFecFin	=={ Ñ
.
==Ñ Ö
Value
==Ö ä
.
==ä ã
ToString
==ã ì
(
==ì î
$str
==î †
)
==† °
,
==° ¢
CodSede
==£ ™
,
==™ ´
txtPaciente
==¨ ∑
.
==∑ ∏
Text
==∏ º
,
==º Ω
txtDocIdentidad
==æ Õ
.
==Õ Œ
Text
==Œ “
,
==“ ”
$str
==‘ ÷
,
==÷ ◊
$str
==ÿ €
)
==€ ‹
)
==‹ ›
;
==› ﬁ 
dgvResultadoConsulta@@  
.@@  !
AutoGenerateColumns@@! 4
=@@5 6
false@@7 <
;@@< = 
dgvResultadoConsultaAA  
.AA  !

DataSourceAA! +
=AA, -
oListAA. 3
;AA3 4
ifCC 
(CC 
oListCC 
.CC 
CountCC 
>=CC 
$numCC !
)CC! "

MessageBoxDD 
.DD 
ShowDD 
(DD  
$str	DD  Ö
,
DDÖ Ü
$str
DDá î
,
DDî ï
MessageBoxButtons
DDñ ß
.
DDß ®
OK
DD® ™
,
DD™ ´
MessageBoxIcon
DD¨ ∫
.
DD∫ ª
Warning
DDª ¬
)
DD¬ √
;
DD√ ƒ
}EE 	
privateGG 
voidGG 
btnBuscar_ClickGG $
(GG$ %
objectGG% +
senderGG, 2
,GG2 3
	EventArgsGG4 =
eGG> ?
)GG? @
{HH 	$
CargarGrillaDatosReservaII $
(II$ %
)II% &
;II& '
}JJ 	
privateLL 
voidLL 
pConfiguraGrillaLL %
(LL% &
)LL& '
{MM 	 
dgvResultadoConsultaNN  
.NN  !
AutoGenerateColumnsNN! 4
=NN5 6
falseNN7 <
;NN< =
stringPP 
[PP 
,PP 
]PP 
fmtGrdPP 
=PP 
{PP  
{RR 
$strRR *
,RR* +
$strRR, 6
,RR6 7
$strRR8 <
,RR< =
$strRR= @
}RR@ A
,RRA B
{SS 
$strSS )
,SS) *
$strSS+ 4
,SS4 5
$strSS6 :
,SS: ;
$strSS; >
}SS> ?
,SS? @
{TT 
$strTT /
,TT/ 0
$strTT1 >
,TT> ?
$strTT@ E
,TTE F
$strTTF I
}TTI J
,TTJ K
{VV 
$strVV *
,VV* +
$strVV, ;
,VV; <
$strVV= B
,VVB C
$strVVC F
}VVF G
,VVG H
{WW 
$strWW *
,WW* +
$strWW, 9
,WW9 :
$strWW; @
,WW@ A
$strWWA D
}WWD E
,WWE F
{XX 
$strXX .
,XX. /
$strXX0 :
,XX: ;
$strXX< A
,XXA B
$strXXB E
}XXE F
,XXF G
{ZZ 
$strZZ &
,ZZ& '
$strZZ( .
,ZZ. /
$strZZ0 4
,ZZ4 5
$strZZ5 8
}ZZ8 9
,ZZ9 :
{[[ 
$str[[ .
,[[. /
$str[[0 >
,[[> ?
$str[[@ E
,[[E F
$str[[F I
}[[I J
,[[J K
{\\ 
$str\\ 4
,\\4 5
$str\\6 B
,\\B C
$str\\D I
,\\I J
$str\\J M
}\\M N
,\\N O
{^^ 
$str^^ ,
,^^, -
$str^^. 6
,^^6 7
$str^^8 =
,^^= >
$str^^> A
}^^A B
,^^B C
{__ 
$str__ &
,__& '
$str__( 3
,__3 4
$str__5 9
,__9 :
$str__: =
}__= >
,__> ?
{`` 
$str`` '
,``' (
$str``) 3
,``3 4
$str``5 9
,``9 :
$str``: =
}``= >
,``> ?
{bb 
$strbb (
,bb( )
$strbb* 6
,bb6 7
$strbb8 <
,bb< =
$strbb= @
}bb@ A
,bbA B
{cc 
$strcc 4
,cc4 5
$strcc6 B
,ccB C
$strccD I
,ccI J
$strccJ M
}ccM N
,ccN O
}hh 
;hh 
utilWFii 
.ii 
FmtGrdii 
(ii  
dgvResultadoConsultaii .
,ii. /
fmtGrdii0 6
)ii6 7
;ii7 8
}kk 	
}nn 
}oo 